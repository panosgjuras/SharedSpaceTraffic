simu<-function(x, circ, saf, act, name){
df <- data.frame(dped = x, dflow = x)
df['s_circ']<-circ/15
df['s_saf']<-saf/15
df['s_act']<-act/15
df["cross"] <- name
df["comply"]<- comply(df$dped/100, df$dflow/100, df$s_saf, df$s_act)
df["pedcross"]<-pedcross(df$dped/100, df$dflow/100, df$s_saf, df$s_act)
return(df)}
x = seq(-625, 625, by = 10)
pldf2<-simu(x, 0, 0, 15, 'circ: 0%; saf: 0%; act: 100%')
# HOT HOT HOT HOT FINALLY
traf$pedcross2<-1/exp(traf$pedcross)
model77<-lm(pedcross2 ~ dflow + dped + shmaxact + shminsafe, data = traf[-c(228, 226, 196, 70, 31, 59, 46),])
summary(model77)
ols_vif_tol(model77)
gvlma(model77)
model88<-lm(comply ~ dflow + dped + shmaxact + shminsafe, data = traf[-c(250, 170, 157),])
summary(model88)
ols_vif_tol(model88)
gvlma(model88)
pedcross <- function(dped, dflow, s_saf, s_act){
b0 = model77[["coefficients"]][["(Intercept)"]]
b1 = model77[["coefficients"]][["dflow"]]
b2 = model77[["coefficients"]][["dped"]]
b3 = model77[["coefficients"]][["shmaxact"]]
b3 = model77[["coefficients"]][["shminsafe"]]
pedcross <- -log(b0 + b1 * dflow + b2 * dped + b3 * s_saf + b4 * s_act)
return(pedcross)}
comply<-function(dped, dflow, s_saf, s_act){
b0 = model88[["coefficients"]][["(Intercept)"]]
b1 = model88[["coefficients"]][["dflow"]]
b2 = model88[["coefficients"]][["dped"]]
b3 = model88[["coefficients"]][["shmaxact"]]
b3 = model88[["coefficients"]][["shminsafe"]]
comply <- b0 + b1 * dflow + b2 * dped + b3 * s_saf + b4 * s_act
return(comply)}
simu<-function(x, circ, saf, act, name){
df <- data.frame(dped = x, dflow = x)
df['s_circ']<-circ/15
df['s_saf']<-saf/15
df['s_act']<-act/15
df["cross"] <- name
df["comply"]<- comply(df$dped/100, df$dflow/100, df$s_saf, df$s_act)
df["pedcross"]<-pedcross(df$dped/100, df$dflow/100, df$s_saf, df$s_act)
return(df)}
x = seq(-625, 625, by = 10)
pldf2<-simu(x, 0, 0, 15, 'circ: 0%; saf: 0%; act: 100%')
pedcross <- function(dped, dflow, s_saf, s_act){
b0 = model77[["coefficients"]][["(Intercept)"]]
b1 = model77[["coefficients"]][["dflow"]]
b2 = model77[["coefficients"]][["dped"]]
b3 = model77[["coefficients"]][["shmaxact"]]
b4 = model77[["coefficients"]][["shminsafe"]]
pedcross <- -log(b0 + b1 * dflow + b2 * dped + b3 * s_saf + b4 * s_act)
return(pedcross)}
comply<-function(dped, dflow, s_saf, s_act){
b0 = model88[["coefficients"]][["(Intercept)"]]
b1 = model88[["coefficients"]][["dflow"]]
b2 = model88[["coefficients"]][["dped"]]
b3 = model88[["coefficients"]][["shmaxact"]]
b4 = model88[["coefficients"]][["shminsafe"]]
comply <- b0 + b1 * dflow + b2 * dped + b3 * s_saf + b4 * s_act
return(comply)}
simu<-function(x, circ, saf, act, name){
df <- data.frame(dped = x, dflow = x)
df['s_circ']<-circ/15
df['s_saf']<-saf/15
df['s_act']<-act/15
df["cross"] <- name
df["comply"]<- comply(df$dped/100, df$dflow/100, df$s_saf, df$s_act)
df["pedcross"]<-pedcross(df$dped/100, df$dflow/100, df$s_saf, df$s_act)
return(df)}
x = seq(-625, 625, by = 10)
pedcross <- function(dped, dflow, s_saf, s_act){
b0 = model77[["coefficients"]][["(Intercept)"]]
b1 = model77[["coefficients"]][["dflow"]]
b2 = model77[["coefficients"]][["dped"]]
b3 = model77[["coefficients"]][["shmaxact"]]
b4 = model77[["coefficients"]][["shminsafe"]]
pedcross <- -log(b0 + b1 * dflow + b2 * dped + b3 * s_saf + b4 * s_act)
return(pedcross)}
comply<-function(dped, dflow, s_saf, s_act){
b0 = model88[["coefficients"]][["(Intercept)"]]
b1 = model88[["coefficients"]][["dflow"]]
b2 = model88[["coefficients"]][["dped"]]
b3 = model88[["coefficients"]][["shmaxact"]]
b4 = model88[["coefficients"]][["shminsafe"]]
comply <- b0 + b1 * dflow + b2 * dped + b3 * s_saf + b4 * s_act
return(comply)}
simu<-function(x, circ, saf, act, name){
df <- data.frame(dped = x, dflow = x)
df['s_circ']<-circ/15
df['s_saf']<-saf/15
df['s_act']<-act/15
df["cross"] <- name
df["comply_veh"]<- comply(0, df$dflow, df$s_saf, df$s_act)
df["pedcross_veh"]<-pedcross(0, df$dflow, df$s_saf, df$s_act)
df["comply_ped"]<- comply(df$dped, 0, df$s_saf, df$s_act)
df["pedcross_ped"]<-pedcross(df$dped, 0, df$s_saf, df$s_act)
return(df)}
x = seq(-625, 625, by = 10)
pldf2<-simu(x, 0, 0, 15, 'circ: 0%; saf: 0%; act: 100%')
pldf2<-rbind(pdlf2, simu(x, 3, 3, 9, 'circ: 20%; saf: 20%; act: 60%'))
pldf2<-rbind(pdlf2, simu(x, 4.5, 4.5, 6, 'circ: 30%; saf: 30%; act: 40%'))
pldf2<-rbind(pdlf2, simu(x, 6, 6, 3, 'circ: 40%; saf: 40%; act: 20%'))
pldf2<-rbind(pdlf2, simu(x, 7.5, 7.5, 0, 'circ: 50%; saf: 50%; act: 0%'))
pldf2<-simu(x, 0, 0, 15, 'circ: 0%; saf: 0%; act: 100%')
pldf2<-rbind(pdlf2, simu(x, 3, 3, 9, 'circ: 20%; saf: 20%; act: 60%'))
pldf2<-simu(x, 0, 0, 15, 'circ: 0%; saf: 0%; act: 100%')
pldf2<-rbind(pldf2, simu(x, 3, 3, 9, 'circ: 20%; saf: 20%; act: 60%'))
pldf2<-rbind(pldf2, simu(x, 4.5, 4.5, 6, 'circ: 30%; saf: 30%; act: 40%'))
pldf2<-rbind(pldf2, simu(x, 6, 6, 3, 'circ: 40%; saf: 40%; act: 20%'))
pldf2<-rbind(pldf2, simu(x, 7.5, 7.5, 0, 'circ: 50%; saf: 50%; act: 0%'))
pldf2<-rbind(pldf2, simu(x, 0, 15, 0, 'circ: 0%; saf: 100%; act: 0%'))
pldf2<-rbind(pldf2, simu(x, 3, 9, 3, 'circ: 20%; saf: 60%; act: 20%'))
pldf2<-rbind(pldf2, simu(x, 6, 4.5, 4.5, 'circ: 40%; saf: 30%; act: 30%'))
pldf2<-rbind(pldf2, simu(x, 9, 3, 3, 'circ: 60%; saf: 20%; act: 60%'))
pldf2<-rbind(pldf2, simu(x, 15, 0, 0, 'circ: 100%; saf: 0%; act: 0%'))
ggplot(pldf2, aes(x = ped, y = as.factor(cross))) + geom_raster(aes(fill = pedcross_veh)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = pedcross_veh)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
x = seq(-625, 625, by = 10)
pldf2<-simu(x, 0, 0, 15, 's1: circ: 0%; saf: 0%; act: 100%')
pldf2<-rbind(pldf2, simu(x, 3, 3, 9, 's2: circ: 20%; saf: 20%; act: 60%'))
pldf2<-rbind(pldf2, simu(x, 4.5, 4.5, 6, 's3: circ: 30%; saf: 30%; act: 40%'))
pldf2<-rbind(pldf2, simu(x, 6, 6, 3, 's4: circ: 40%; saf: 40%; act: 20%'))
pldf2<-rbind(pldf2, simu(x, 7.5, 7.5, 0, 's5: circ: 50%; saf: 50%; act: 0%'))
pldf2<-rbind(pldf2, simu(x, 0, 15, 0, 's6: circ: 0%; saf: 100%; act: 0%'))
pldf2<-rbind(pldf2, simu(x, 3, 9, 3, 's7: circ: 20%; saf: 60%; act: 20%'))
pldf2<-rbind(pldf2, simu(x, 6, 4.5, 4.5, 's8: circ: 40%; saf: 30%; act: 30%'))
pldf2<-rbind(pldf2, simu(x, 9, 3, 3, 's9: circ: 60%; saf: 20%; act: 60%'))
pldf2<-rbind(pldf2, simu(x, 15, 0, 0, 's10: circ: 100%; saf: 0%; act: 0%'))
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = pedcross_veh)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
pldf2<-simu(x, 0, 0, 15, 's1: circ: 0%; saf: 0%; act: 100%')
pldf2<-rbind(pldf2, simu(x, 3, 3, 9, 's2: circ: 20%; saf: 20%; act: 60%'))
pldf2<-rbind(pldf2, simu(x, 4.5, 4.5, 6, 's3: circ: 30%; saf: 30%; act: 40%'))
pldf2<-rbind(pldf2, simu(x, 6, 6, 3, 's4: circ: 40%; saf: 40%; act: 20%'))
pldf2<-rbind(pldf2, simu(x, 7.5, 7.5, 0, 's5: circ: 50%; saf: 50%; act: 0%'))
pldf2<-rbind(pldf2, simu(x, 0, 15, 0, 's6: circ: 0%; saf: 100%; act: 0%'))
pldf2<-rbind(pldf2, simu(x, 3, 9, 3, 's7: circ: 20%; saf: 60%; act: 20%'))
pldf2<-rbind(pldf2, simu(x, 6, 4.5, 4.5, 's8: circ: 40%; saf: 30%; act: 30%'))
pldf2<-rbind(pldf2, simu(x, 9, 3, 3, 's9: circ: 60%; saf: 20%; act: 60%'))
pldf2<-rbind(pldf2, simu(x, 15, 0, 0, 's99: circ: 100%; saf: 0%; act: 0%'))
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = pedcross_veh)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = pedcross_veh)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = comply_ped)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = pedcross_ped)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = comply_ped)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
ggplot(pldf2, aes(x = dveh, y = as.factor(cross))) + geom_raster(aes(fill = pedcross_veh)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross_veh)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = comply_veh)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = pedcross_ped)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = comply_ped)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross_veh)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = comply_veh)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = pedcross_ped)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = comply_ped)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross_veh)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = comply_veh)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
x = seq(-625, 625, by = 10)
y = seq(625, -625, by = 10)
pldf2<-simu(x, y, 0, 0, 15, 's1: circ: 0%; saf: 0%; act: 100%')
pldf2<-rbind(pldf2, simu(x, y, 3, 3, 9, 's2: circ: 20%; saf: 20%; act: 60%'))
x = seq(-625, 625, by = 10)
y = seq(625, -625, by = 10)
y = seq(625, -625, by = -10)
pldf2<-simu(x, y, 0, 0, 15, 's1: circ: 0%; saf: 0%; act: 100%')
pldf2<-rbind(pldf2, simu(x, y, 3, 3, 9, 's2: circ: 20%; saf: 20%; act: 60%'))
pldf2<-rbind(pldf2, simu(x, y, 4.5, 4.5, 6, 's3: circ: 30%; saf: 30%; act: 40%'))
pldf2<-rbind(pldf2, simu(x, y, 6, 6, 3, 's4: circ: 40%; saf: 40%; act: 20%'))
pldf2<-rbind(pldf2, simu(x, y, 7.5, 7.5, 0, 's5: circ: 50%; saf: 50%; act: 0%'))
simu<-function(x, y, circ, saf, act, name){
df <- data.frame(dped = x, dflow = y)
df['s_circ']<-circ/15
df['s_saf']<-saf/15
df['s_act']<-act/15
df["cross"] <- name
df["comply_veh"]<- comply(0, df$dflow, df$s_saf, df$s_act)
df["pedcross_veh"]<-pedcross(0, df$dflow, df$s_saf, df$s_act)
df["comply_ped"]<- comply(df$dped, 0, df$s_saf, df$s_act)
df["pedcross_ped"]<-pedcross(df$dped, 0, df$s_saf, df$s_act)
return(df)}
x = seq(-625, 625, by = 10)
y = seq(625, -625, by = -10)
pldf2<-simu(x, y, 0, 0, 15, 's1: circ: 0%; saf: 0%; act: 100%')
pldf2<-rbind(pldf2, simu(x, y, 3, 3, 9, 's2: circ: 20%; saf: 20%; act: 60%'))
pldf2<-rbind(pldf2, simu(x, y, 4.5, 4.5, 6, 's3: circ: 30%; saf: 30%; act: 40%'))
pldf2<-rbind(pldf2, simu(x, y, 6, 6, 3, 's4: circ: 40%; saf: 40%; act: 20%'))
pldf2<-rbind(pldf2, simu(x, y, 7.5, 7.5, 0, 's5: circ: 50%; saf: 50%; act: 0%'))
pldf2<-rbind(pldf2, simu(x, y, 0, 15, 0, 's6: circ: 0%; saf: 100%; act: 0%'))
pldf2<-rbind(pldf2, simu(x, y, 3, 9, 3, 's7: circ: 20%; saf: 60%; act: 20%'))
pldf2<-rbind(pldf2, simu(x, y, 6, 4.5, 4.5, 's8: circ: 40%; saf: 30%; act: 30%'))
pldf2<-rbind(pldf2, simu(x, y, 9, 3, 3, 's9: circ: 60%; saf: 20%; act: 60%'))
pldf2<-rbind(pldf2, simu(x, y, 15, 0, 0, 's99: circ: 100%; saf: 0%; act: 0%'))
View(pldf2)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
simu<-function(x, y, circ, saf, act, name){
df <- data.frame(dped = x, dflow = y)
df['s_circ']<-circ/15
df['s_saf']<-saf/15
df['s_act']<-act/15
df["cross"] <- name
df["comply_veh"]<- comply(0, df$dflow, df$s_saf, df$s_act)
df["pedcross_veh"]<-pedcross(0, df$dflow, df$s_saf, df$s_act)
df["comply_ped"]<- comply(df$dped, 0, df$s_saf, df$s_act)
df["pedcross_ped"]<-pedcross(df$dped, 0, df$s_saf, df$s_act)
df["comply"]<- comply(df$dped, df$dflow, df$s_saf, df$s_act)
df["pedcross"]<-pedcross(df$dped, df$dped, df$s_saf, df$s_act)
return(df)}
x = seq(-625, 625, by = 10)
y = seq(625, -625, by = -10)
pldf2<-simu(x, y, 0, 0, 15, 's1: circ: 0%; saf: 0%; act: 100%')
pldf2<-rbind(pldf2, simu(x, y, 3, 3, 9, 's2: circ: 20%; saf: 20%; act: 60%'))
pldf2<-rbind(pldf2, simu(x, y, 4.5, 4.5, 6, 's3: circ: 30%; saf: 30%; act: 40%'))
pldf2<-rbind(pldf2, simu(x, y, 6, 6, 3, 's4: circ: 40%; saf: 40%; act: 20%'))
pldf2<-rbind(pldf2, simu(x, y, 7.5, 7.5, 0, 's5: circ: 50%; saf: 50%; act: 0%'))
pldf2<-rbind(pldf2, simu(x, y, 0, 15, 0, 's6: circ: 0%; saf: 100%; act: 0%'))
pldf2<-rbind(pldf2, simu(x, y, 3, 9, 3, 's7: circ: 20%; saf: 60%; act: 20%'))
pldf2<-rbind(pldf2, simu(x, y, 6, 4.5, 4.5, 's8: circ: 40%; saf: 30%; act: 30%'))
pldf2<-rbind(pldf2, simu(x, y, 9, 3, 3, 's9: circ: 60%; saf: 20%; act: 60%'))
pldf2<-rbind(pldf2, simu(x, y, 15, 0, 0, 's99: circ: 100%; saf: 0%; act: 0%'))
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = comply)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = comply)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = comply)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = comply)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = comply)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = comply)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = comply)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(y = dflow, x = as.factor(cross))) + geom_raster(aes(fill = pedcross)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = comply)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = comply)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
timeplot<-function(df,street,text){ # time series plot, relationship between dspeed, lspeed, pedcross
p<-ggplot(subset(df, case==street)) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.75, linetype='solid') +
# geom_line(aes(x = 1:nrow(subset(df, case==street)), y = comply*20-0.25, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = (pedcross*20) - 6, color = 'Crossings per pedestrian'), size=0.75) +
scale_color_manual(name = '', values = c('Deviation from mean traffic speed'='red',
#'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', limits = c(0,105), breaks=seq(0,nrow(subset(df, case==street)),5)) +
scale_y_continuous(name = 'Speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ (./20) + 0.3, name="Pedestrian crossing rate")) +
ggtitle(text) + theme_bw() + theme(legend.position="bottom")
return(p)}
timeplot2<-function(df,street,text){ # time series plot, relationship between dspeed, lspeed, pedcross
p<-ggplot(subset(df, case==street)) +
# geom_line(aes(x = 1:nrow(subset(df, case==street)), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.75, linetype='solid') +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = comply, color = 'Compliance rate'), size=0.75) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = pedcross + 0.5, color = 'Crossings per pedestrian'), size=0.75) +
scale_color_manual(name = '', values = c('Compliance rate'='green',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(df, case==street)),5)) +
scale_y_continuous(name = 'Compliance rate', limits = c(0,2),
sec.axis = sec_axis( trans=~ . - 0.5, name="Pedestrian crossing rate")) +
ggtitle(text) + theme_bw() + theme(legend.position="bottom")
return(p)}
ggarrange(timeplot(traf,'fsbr','Frankfurter Stra?e, Bad Rothenfelde, Germany'),
timeplot(traf,'lsho','Lange Stra?e, Hessisch Oldendorf, Germany'),
timeplot(traf,'mke','Marktplatz, K?nigslutter am Elm, Germany'),
timeplot(traf,'shnaf','Amalias Street, Nafplio, Greece'), ncol=1, nrow=4,
common.legend = TRUE, legend="bottom")
ggarrange(timeplot2(traf,'fsbr','Frankfurter Stra?e, Bad Rothenfelde, Germany'),
timeplot2(traf,'lsho','Lange Stra?e, Hessisch Oldendorf, Germany'),
timeplot2(traf,'mke','Marktplatz, K?nigslutter am Elm, Germany'),
timeplot2(traf,'shnaf','Amalias Street, Nafplio, Greece'), ncol=1, nrow=4,
common.legend = TRUE, legend="bottom")
ggarrange(timeplot(traf,'fsbr','Frankfurter Stra?e, Bad Rothenfelde, Germany'),
timeplot(traf,'lsho','Lange Stra?e, Hessisch Oldendorf, Germany'),
timeplot(traf,'mke','Marktplatz, K?nigslutter am Elm, Germany'),
timeplot(traf,'shnaf','Amalias Street, Nafplio, Greece'), ncol=1, nrow=4,
common.legend = TRUE, legend="bottom")
ggarrange(timeplot(traf,'fsbr','Frankfurter Street, Bad Rothenfelde, Germany'),
timeplot(traf,'lsho','Lange Street, Hessisch Oldendorf, Germany'),
timeplot(traf,'mke','Marktplatz, K?nigslutter am Elm, Germany'),
timeplot(traf,'shnaf','Amalias Street, Nafplio, Greece'), ncol=1, nrow=4,
common.legend = TRUE, legend="bottom")
# Simulation of these models: model88 and model77
pedcross <- function(dped, dflow, s_saf, s_act){
b0 = model77[["coefficients"]][["(Intercept)"]]
b1 = model77[["coefficients"]][["dflow"]]
b2 = model77[["coefficients"]][["dped"]]
b3 = model77[["coefficients"]][["shmaxact"]]
b4 = model77[["coefficients"]][["shminsafe"]]
pedcross <- -log(b0 + b1 * dflow + b2 * dped + b3 * s_act + b4 * s_saf)
return(pedcross)}
comply<-function(dped, dflow, s_saf, s_act){
b0 = model88[["coefficients"]][["(Intercept)"]]
b1 = model88[["coefficients"]][["dflow"]]
b2 = model88[["coefficients"]][["dped"]]
b3 = model88[["coefficients"]][["shmaxact"]]
b4 = model88[["coefficients"]][["shminsafe"]]
comply <- b0 + b1 * dflow + b2 * dped + b3 * s_act + b4 * s_saf
return(comply)}
simu<-function(x, y, circ, saf, act, name){
df <- data.frame(dped = x, dflow = y)
df['s_circ']<-circ/15
df['s_saf']<-saf/15
df['s_act']<-act/15
df["cross"] <- name
df["comply_veh"]<- comply(0, df$dflow, df$s_saf, df$s_act)
df["pedcross_veh"]<-pedcross(0, df$dflow, df$s_saf, df$s_act)
df["comply_ped"]<- comply(df$dped, 0, df$s_saf, df$s_act)
df["pedcross_ped"]<-pedcross(df$dped, 0, df$s_saf, df$s_act)
df["comply"]<- comply(df$dped, df$dflow, df$s_saf, df$s_act)
df["pedcross"]<-pedcross(df$dped, df$dped, df$s_saf, df$s_act)
return(df)}
x = seq(-625, 625, by = 10) # the less, the more
y = seq(625, -625, by = -10) # the more, the less
# scenario simualtion
pldf2<-simu(x, y, 0, 0, 15, 's1: circ: 0%; saf: 0%; act: 100%')
pldf2<-rbind(pldf2, simu(x, y, 3, 3, 9, 's2: circ: 20%; saf: 20%; act: 60%'))
pldf2<-rbind(pldf2, simu(x, y, 4.5, 4.5, 6, 's3: circ: 30%; saf: 30%; act: 40%'))
pldf2<-rbind(pldf2, simu(x, y, 6, 6, 3, 's4: circ: 40%; saf: 40%; act: 20%'))
pldf2<-rbind(pldf2, simu(x, y, 7.5, 7.5, 0, 's5: circ: 50%; saf: 50%; act: 0%'))
pldf2<-rbind(pldf2, simu(x, y, 0, 15, 0, 's6: circ: 0%; saf: 100%; act: 0%'))
pldf2<-rbind(pldf2, simu(x, y, 3, 9, 3, 's7: circ: 20%; saf: 60%; act: 20%'))
pldf2<-rbind(pldf2, simu(x, y, 6, 4.5, 4.5, 's8: circ: 40%; saf: 30%; act: 30%'))
pldf2<-rbind(pldf2, simu(x, y, 9, 3, 3, 's9: circ: 60%; saf: 20%; act: 60%'))
pldf2<-rbind(pldf2, simu(x, y, 15, 0, 0, 's99: circ: 100%; saf: 0%; act: 0%'))
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
ggplot(pldf2, aes(x = dped, y = as.factor(cross))) + geom_raster(aes(fill = comply)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "", position = "right") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of pedestrian flow in peds/h") +
scale_fill_viridis_c("Speed compliance rate", option = "B", direction = 1)
# HOT HOT HOT HOT FINALLY
traf$pedcross2<-1/exp(traf$pedcross)
model77<-lm(pedcross2 ~ dflow + dped + shmaxact + shminsafe, data = traf[-c(228, 226, 196, 70, 31, 59, 46),])
summary(model77)
ols_vif_tol(model77)
gvlma(model77)
summary(model77)
summary(model88)
ggplot(pldf2, aes(x = dflow, y = as.factor(cross))) + geom_raster(aes(fill = pedcross)) + theme_bw() +
theme(axis.text.y = element_text(size = 11.5)) +
scale_y_discrete(name = "") + theme(legend.position="bottom") +
scale_x_continuous(name = "Deviation of vehicle flow in veh/h") +
scale_fill_viridis_c("Pedestrian crossing rate", option = "D", direction = 1)
