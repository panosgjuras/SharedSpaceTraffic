linetype ='dashed', size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20), color = 'blue', size=0.6) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h',
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Second Axis")) + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed), color = 'brown1', size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed), color = 'black',
linetype ='dashed', size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20), color = 'darkblue', size=0.6) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h',
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Second Axis")) + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed), color = 'brown1', size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed), color = 'black',
linetype ='dashed', size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20), color = 'darkblue', size=0.6) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h',
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed), color = 'brown1', size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed), color = 'black',
linetype ='dashed', size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20), color = 'darkblue', size=0.7) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h',
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed), color = 'brown1', size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed), color = 'black',
linetype ='dashed', size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20), color = 'darkblue', size=0.7) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-20,20),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed), color = 'brown1', size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed), color = 'black',
linetype ='dashed', size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20), color = 'darkblue', size=0.7) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed), color = 'brown1', size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed), color = 'black',
linetype ='dashed', size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20), color = 'darkblue', size=0.7) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed), color = 'brown1', size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed), color = 'black',
linetype ='dashed', size=0.7, title='dev') +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20), color = 'darkblue', size=0.7) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed), color = 'brown1', size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed), color = 'black',
linetype ='dashed', size=0.7, name='dev') +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20), color = 'darkblue', size=0.7) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed), size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed), size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20), color = 'darkblue', size=0.7) +
scale_linetype_manual(values = c('dashed','solid','solid')) +
scale_color_manual(values = c('brown1','black','blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed), size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed), size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20), size=0.7) +
scale_linetype_manual(values = c('dashed','solid','solid')) +
scale_color_manual(values = c('brown1','black','blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed), size=0.7, color=fun, linetype = fun) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed), size=0.7, color=fun, linetype = fun) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20), size=0.7, color=fun, linetype = fun) +
scale_linetype_manual(values = c('dashed','solid','solid')) +
scale_color_manual(values = c('brown1','black','blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed, color = 'Deviation from speed limit' ), size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.7) +
scale_linetype_manual(values = c('dashed','solid','solid')) +
scale_color_manual(values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed, color = 'Deviation from mean traffic speed',
linetype = 'Deviation from mean traffic speed'), size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed, color = 'Deviation from speed limit',
linetype = 'Deviation from speed limit'), size=0.7) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian',
linetype = 'Crossings per pedestrian'), size=0.7) +
scale_linetype_manual(values = c('Deviation from mean traffic speed'='dashed',
'Deviation from speed limit'='solid',
'Crossings per pedestrian'='solid')) +
scale_color_manual(values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.75) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed, color = 'Deviation from speed limit'), size=0.75) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.75) +
scale_color_manual(values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='red',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.75) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed, color = 'Deviation from speed limit'), size=0.75) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.75) +
scale_color_manual(values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(name = 'Series', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw()
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(name = 'Series', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw(legend.position="bottom")
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(name = 'Series', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw() + theme(legend.position="bottom")
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(name = '', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw() + theme(legend.position="bottom")
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6, linetype='dashed') +
scale_color_manual(name = '', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw() + theme(legend.position="bottom")
ggplot(subset(traf, case=='shnaf')) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6, linetype='dashed') +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(traf, case=='shnaf')), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(name = '', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(traf, case=='shnaf')),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle("Amalias Street, Nafplio") + theme_bw() + theme(legend.position="bottom")
timeplot(traf,'shnaf','Amalias Street, Nafplio')
timeplot<-function(df,street,text){
p<-ggplot(subset(df, case==street)) +
geom_line(as(x = 1:nrow(subset(df, case==street)), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6, linetype='dashed') +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(name = '', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(df, case==street)),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle(text) + theme_bw() + theme(legend.position="bottom")
return(p)}
timeplot(traf,'shnaf','Amalias Street, Nafplio')
timeplot<-function(df,street,text){
p<-ggplot(subset(df, case==street)) +
geom_line(as(x = 1:nrow(subset(df, case==street)), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6, linetype='dashed') +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(name = '', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(df, case==street)),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle(text) + theme_bw() + theme(legend.position="bottom")
return(p)}
timeplot(traf,'shnaf','Amalias Street, Nafplio')
timeplot<-function(df,street,text){
p<-ggplot(subset(df, case==street)) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6, linetype='dashed') +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(name = '', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(df, case==street)),5)) +
scale_y_continuous(name = 'Traffic speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Number of crossings per pedestrian")) +
ggtitle(text) + theme_bw() + theme(legend.position="bottom")
return(p)}
timeplot(traf,'shnaf','Amalias Street, Nafplio')
ggarrange(timeplot(traf,'fsbr','Amalias Street, Nafplio'),
timeplot(traf,'lsho','Amalias Street, Nafplio'),
timeplot(traf,'mke','Amalias Street, Nafplio'),
timeplot(traf,'shnaf','Amalias Street, Nafplio'), ncol=1, nrow=4)
ggarrange(timeplot(traf,'fsbr','Amalias Street, Nafplio'),
timeplot(traf,'lsho','Amalias Street, Nafplio'),
timeplot(traf,'mke','Amalias Street, Nafplio'),
timeplot(traf,'shnaf','Amalias Street, Nafplio'), ncol=1, nrow=4,
common.legend = TRUE, legend="bottom")
timeplot<-function(df,street,text){
p<-ggplot(subset(df, case==street)) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6, linetype='dashed') +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(name = '', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(df, case==street)),5)) +
scale_y_continuous(name = 'Speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Crossings per pedestrian")) +
ggtitle(text) + theme_bw() + theme(legend.position="bottom")
return(p)}
ggarrange(timeplot(traf,'fsbr','Amalias Street, Nafplio'),
timeplot(traf,'lsho','Amalias Street, Nafplio'),
timeplot(traf,'mke','Amalias Street, Nafplio'),
timeplot(traf,'shnaf','Amalias Street, Nafplio'), ncol=1, nrow=4,
common.legend = TRUE, legend="bottom")
ggarrange(timeplot(traf,'fsbr','Frankfurter Straße, Bad Rothenfelde, Germany'),
timeplot(traf,'lsho','Lange Straße, Hessisch Oldendorf, Germany'),
timeplot(traf,'mke','Marktplatz, Königslutter am Elm, Germany'),
timeplot(traf,'shnaf','Amalias Street, Nafplio, Greece'), ncol=1, nrow=4,
common.legend = TRUE, legend="bottom")
timeplot<-function(df,street,text){
p<-ggplot(subset(df, case==street)) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6, linetype='dashed') +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(name = '', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,105,5)) +
scale_y_continuous(name = 'Speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Crossings per pedestrian")) +
ggtitle(text) + theme_bw() + theme(legend.position="bottom")
return(p)}
ggarrange(timeplot(traf,'fsbr','Frankfurter Straße, Bad Rothenfelde, Germany'),
timeplot(traf,'lsho','Lange Straße, Hessisch Oldendorf, Germany'),
timeplot(traf,'mke','Marktplatz, Königslutter am Elm, Germany'),
timeplot(traf,'shnaf','Amalias Street, Nafplio, Greece'), ncol=1, nrow=4,
common.legend = TRUE, legend="bottom")
timeplot<-function(df,street,text){
p<-ggplot(subset(df, case==street)) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6, linetype='dashed') +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(name = '', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,105,5)) +
scale_y_continuous(name = 'Speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Crossings per pedestrian")) +
ggtitle(text) + theme_bw() + theme(legend.position="bottom")
return(p)}
ggarrange(timeplot(traf,'fsbr','Frankfurter Straße, Bad Rothenfelde, Germany'),
timeplot(traf,'lsho','Lange Straße, Hessisch Oldendorf, Germany'),
timeplot(traf,'mke','Marktplatz, Königslutter am Elm, Germany'),
timeplot(traf,'shnaf','Amalias Street, Nafplio, Greece'), ncol=1, nrow=4,
common.legend = TRUE, legend="bottom")
timeplot<-function(df,street,text){
p<-ggplot(subset(df, case==street)) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6, linetype='dashed') +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(name = '', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,nrow(subset(df, case==street)),5)) +
scale_y_continuous(name = 'Speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Crossings per pedestrian")) +
ggtitle(text) + theme_bw() + theme(legend.position="bottom")
return(p)}
ggarrange(timeplot(traf,'fsbr','Frankfurter Straße, Bad Rothenfelde, Germany'),
timeplot(traf,'lsho','Lange Straße, Hessisch Oldendorf, Germany'),
timeplot(traf,'mke','Marktplatz, Königslutter am Elm, Germany'),
timeplot(traf,'shnaf','Amalias Street, Nafplio, Greece'), ncol=1, nrow=4,
common.legend = TRUE, legend="bottom")
timeplot<-function(df,street,text){
p<-ggplot(subset(df, case==street)) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6, linetype='dashed') +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(name = '', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,120,5)) +
scale_y_continuous(name = 'Speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Crossings per pedestrian")) +
ggtitle(text) + theme_bw() + theme(legend.position="bottom")
return(p)}
ggarrange(timeplot(traf,'fsbr','Frankfurter Straße, Bad Rothenfelde, Germany'),
timeplot(traf,'lsho','Lange Straße, Hessisch Oldendorf, Germany'),
timeplot(traf,'mke','Marktplatz, Königslutter am Elm, Germany'),
timeplot(traf,'shnaf','Amalias Street, Nafplio, Greece'), ncol=1, nrow=4,
common.legend = TRUE, legend="bottom")
timeplot<-function(df,street,text){
p<-ggplot(subset(df, case==street)) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6, linetype='dashed') +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(name = '', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,120,5)) +
scale_y_continuous(name = 'Speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Crossings per pedestrian")) +
ggtitle(text) + theme_bw() + theme(legend.position="bottom")
return(p)}
ggarrange(timeplot(traf,'fsbr','Frankfurter Straße, Bad Rothenfelde, Germany'),
timeplot(traf,'lsho','Lange Straße, Hessisch Oldendorf, Germany'),
timeplot(traf,'mke','Marktplatz, Königslutter am Elm, Germany'),
timeplot(traf,'shnaf','Amalias Street, Nafplio, Greece'), ncol=1, nrow=4,
common.legend = TRUE, legend="bottom")
timeplot<-function(df,street,text){
p<-ggplot(subset(df, case==street)) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = dspeed, color = 'Deviation from mean traffic speed'), size=0.6, linetype='dashed') +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = lspeed, color = 'Deviation from speed limit'), size=0.6) +
geom_line(aes(x = 1:nrow(subset(df, case==street)), y = (pedcross-0.25)*20, color = 'Crossings per pedestrian'), size=0.6) +
scale_color_manual(name = '', values = c('Deviation from mean traffic speed'='brown1',
'Deviation from speed limit'='black',
'Crossings per pedestrian'='blue2')) +
scale_x_continuous(name = 'Two minutes intervals', breaks=seq(0,120,5)) +
scale_y_continuous(name = 'Speed deviations in km/h', limits = c(-25,25),
sec.axis = sec_axis( trans=~ ./20 + 0.25, name="Crossings per pedestrian")) +
ggtitle(text) + theme_bw() + theme(legend.position="bottom")
return(p)}
ggarrange(timeplot(traf,'fsbr','Frankfurter Straße, Bad Rothenfelde, Germany'),
timeplot(traf,'lsho','Lange Straße, Hessisch Oldendorf, Germany'),
timeplot(traf,'mke','Marktplatz, Königslutter am Elm, Germany'),
timeplot(traf,'shnaf','Amalias Street, Nafplio, Greece'), ncol=1, nrow=4,
common.legend = TRUE, legend="bottom")
# Bollards, yer or no
mean(subset(traf, bollards == 1)$pedcross) - mean(subset(traf, bollards == 0)$pedcross) # 0.10 more crossings per pedestrian
wilcox.test(subset(traf, bollards == 1)$pedcross, subset(traf, bollards == 0)$pedcross, exact=FALSE, paired=FALSE) # significance
mean(subset(traf, bollards == 1)$comply) - mean(subset(traf, bollards == 0)$comply)
wilcox.test(subset(traf, bollards == 1)$comply, subset(traf, bollards == 0)$comply, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, bollards, pedcross, lspeed, '1, if there are bollards')
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, bollards, pedcross, comply, '1, if there are bollards')
ggplot(traf, aes(x=as.factor(case), y = pedcross)) + geom_boxplot() + theme_bw()
ggplot(traf, aes(x=as.factor(case), y = pedcross)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw()
ggplot(traf, aes(x=as.factor(case), y = pedcross), fill=case) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw()
ggplot(traf, aes(x=as.factor(case), y = pedcross), fill=as.factor(case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw()
ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=as.factor(case))) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw()
ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw()
ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_fill_brewer(palette = 'Set1')+ theme_bw()
ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_fill_brewer(palette = 'Set2')+ theme_bw()
ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_fill_brewer(palette = 'Pastel1')+ theme_bw()
ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_fill_brewer(palette = 'Pastel2')+ theme_bw()
ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_fill_brewer(palette = 'Pastel2')+ theme_bw() + theme(legend.position = "none")
ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_x_discrete(name = 'Case', limits = c('Frankfurter Straße', 'Lange Straße',
'Marktplatz', 'Amalias Street'))
ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_x_discrete(name = 'Case', limits = c('Frankfurter Straße', 'Lange Straße',
'Marktplatz', 'Amalias Street')) +
scale_fill_brewer(palette = 'Pastel2')+ theme_bw() + theme(legend.position = "none")
ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_x_discrete(name = 'Case', limits = c('Frankfurter Straße', 'Lange Straße',
'Marktplatz', 'Amalias Street')) +
scale_fill_brewer(palette = 'Pastel2')+ theme_bw() + theme(legend.position = "none")
ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_x_discrete(name = 'Case') +
scale_fill_brewer(palette = 'Pastel2')+ theme_bw() + theme(legend.position = "none")
ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_x_discrete(name = 'Case', labels = c('Frankfurter Straße', 'Lange Straße',
'Marktplatz', 'Amalias Street')) +
scale_fill_brewer(palette = 'Pastel2')+ theme_bw() + theme(legend.position = "none")
ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_x_discrete(name = 'Case', labels = c('Frankfurter Straße', 'Lange Straße',
'Marktplatz', 'Amalias Street')) +
scale_y_continuous(name = 'Number of crossings per pedestrian', limits=c(0,2))
ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_x_discrete(name = 'Case', labels = c('Frankfurter Straße', 'Lange Straße',
'Marktplatz', 'Amalias Street')) +
scale_y_continuous(name = 'Number of crossings per pedestrian', limits=c(0,2)) +
scale_fill_brewer(palette = 'Pastel2')+ theme_bw() + theme(legend.position = "none")
ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_x_discrete(name = 'Case', labels = c('Frankfurter Straße', 'Lange Straße',
'Marktplatz', 'Amalias Street')) +
scale_y_continuous(name = 'Number of crossings per pedestrian', limits=c(0,1.5)) +
scale_fill_brewer(palette = 'Pastel2')+ theme_bw() + theme(legend.position = "none")
ggplot(traf, aes(x=as.factor(case), y = comply, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_x_discrete(name = 'Case', labels = c('Frankfurter Straße', 'Lange Straße',
'Marktplatz', 'Amalias Street')) +
scale_y_continuous(name = 'Speed compliance rate') +
scale_fill_brewer(palette = 'Pastel2')+ theme_bw() + theme(legend.position = "none")
p1<-ggplot(traf, aes(x=as.factor(case), y = pedcross, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_x_discrete(name = 'Case', labels = c('Frankfurter Straße', 'Lange Straße',
'Marktplatz', 'Amalias Street')) +
scale_y_continuous(name = 'Number of crossings per pedestrian', limits=c(0,1.5)) +
scale_fill_brewer(palette = 'Pastel2')+ theme_bw() + theme(legend.position = "none")
p2<-ggplot(traf, aes(x=as.factor(case), y = comply, fill=case)) + geom_boxplot() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_x_discrete(name = 'Case', labels = c('Frankfurter Straße', 'Lange Straße',
'Marktplatz', 'Amalias Street')) +
scale_y_continuous(name = 'Speed compliance rate') +
scale_fill_brewer(palette = 'Pastel2')+ theme_bw() + theme(legend.position = "none")
ggarrange(p1,p2, ncol=1, nrow=2)
ggarrange(timeplot(traf,'fsbr','Frankfurter Straße, Bad Rothenfelde, Germany'),
timeplot(traf,'lsho','Lange Straße, Hessisch Oldendorf, Germany'),
timeplot(traf,'mke','Marktplatz, Königslutter am Elm, Germany'),
timeplot(traf,'shnaf','Amalias Street, Nafplio, Greece'), ncol=1, nrow=4,
common.legend = TRUE, legend="bottom")
