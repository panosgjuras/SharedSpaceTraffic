ped_data<-read.csv2("C:/Users/panos/Google Drive/research_papers/paper17_project_Nafplio1/datasets/pedestrian_dataset_shared_space.csv",
header=T,dec=".",sep=",")
ped_data$time<-as.POSIXct(ped_data$time,format="%H:%M")
# import vehicle data
veh_data<-read.csv2("C:/Users/panos/Google Drive/research_papers/paper17_project_Nafplio1/datasets/vehicle_dataset_shared_space.csv",
header=T,dec=".",sep=",")
veh_data$time<-as.POSIXct(veh_data$time,format="%H:%M:%S")
veh_data$speed2<-1/log(veh_data$speed)
model3<-lm(speed2~park+cross,data=subset(veh_data[-c(438,17,19,54,132),],
shared==1 & gap>2.5 & ped/30<40))
model3<-lm(speed2~park+cross,data=veh_data)
summary(model3)
gvlma(model3)
model3<-lm(speed2~park+cross+shared,data)
model3<-lm(speed2~park+cross+shared,data=veh_data)
summary(model3)
gvlma(model3)
par(mfrow=c(2,2))
plot(model3, pch=20)
model3<-lm(speed2~park+cross,data=subset(veh_data, shared==1))
summary(model3)
gvlma(model3)
par(mfrow=c(2,2))
plot(model3, pch=20)
model3<-lm(speed~park+cross,data=subset(veh_data, shared==1))
summary(model3)
gvlma(model3)
model3<-lm(speed2~park+cross,data=subset(veh_data, shared==1))
summary(model3)
gvlma(model3)
veh_data$speed2<-log(veh_data$speed)
model3<-lm(speed2~park+cross,data=subset(veh_data, shared==1))
summary(model3)
gvlma(model3)
veh_data$speed2<-log(1/veh_data$speed)
model3<-lm(speed2~park+cross,data=subset(veh_data, shared==1))
summary(model3)
gvlma(model3)
plot(speed2)
plot(veh_data$speed2)
hist(veh_data$speed2)
veh_data$speed2<-1/log(veh_data$speed)
hist(veh_data$speed2)
hist(veh_data$speed)
veh_data$speed2<-1/sqrt(veh_data$speed)
hist(veh_data$speed2)
model3<-lm(speed2~park+cross,data=subset(veh_data, shared==1))
summary(model3)
gvlma(model3)
par(mfrow=c(2,2))
plot(model3, pch=20)
plot(veh_data$speed,veh_data$cross)
plot(veh_data$speed,veh_data$cross)
plot(veh_data$speed,veh_data$cross)
plot(veh_data$cross,veh_data$speed)
plot(veh_data$cross,1/veh_data$speed)
veh_data$speed2<-1/veh_data$speed
model3<-lm(speed2~park+cross,data=subset(veh_data, shared==1))
summary(model3)
gvlma(model3)
par(mfrow=c(2,2))
plot(model3, pch=20)
plot(veh_data$cross,1/(0.5*veh_data$speed))
plot(veh_data$cross,1/(0.5*veh_data$speed))
p1<-ggplot(data_car, aes(x = as.factor(accept), y = cycle)) + geom_violin(fill = "coral2")+
labs(title = "Car Users", y="Cycle lane (yes = 1)") + theme(text = element_text(size = 10))
p2<-ggplot(data_pt, aes(x = as.factor(accept), y = cycle)) + geom_violin(fill = "cornflowerblue")+
labs(title="Public Trasnport Users",x = "Acceptability", y="Cycle lane (yes = 1)")
p3<-ggplot(data_vru, aes(x = as.factor(accept), y = cycle)) + geom_violin(fill = "darkseagreen1")+
labs(title="Vulnerable Road Users",x = "Acceptability", y="Cycle lane (yes = 1)")
ggarrange(p1, p2, p3,ncol = 1, nrow = 3)
library(VGAM)
library(corrplot)
library(Rchoice)
library(ggplot2)
library(dplyr)
library(plotly)
library(fmsb)
library(data.table)
library(ggpubr)
p1<-ggplot(data_car, aes(x = as.factor(accept), y = cycle)) + geom_violin(fill = "coral2")+
labs(title = "Car Users", y="Cycle lane (yes = 1)") + theme(text = element_text(size = 10))
p2<-ggplot(data_pt, aes(x = as.factor(accept), y = cycle)) + geom_violin(fill = "cornflowerblue")+
labs(title="Public Trasnport Users",x = "Acceptability", y="Cycle lane (yes = 1)")
p3<-ggplot(data_vru, aes(x = as.factor(accept), y = cycle)) + geom_violin(fill = "darkseagreen1")+
labs(title="Vulnerable Road Users",x = "Acceptability", y="Cycle lane (yes = 1)")
ggarrange(p1, p2, p3,ncol = 1, nrow = 3)
# accept vs cycling infrastructure
p1<-ggplot(data_car, aes(x = as.factor(accept), y = cycle)) + geom_violin(fill = "coral2")+
labs(title = "Car Users", y="Cycle lane (yes = 1)") + theme(text = element_text(size = 10))
#Part 0: packages
#edw auta ta paketa prepei prwta na ta kaneis install kai meta na trekseis tis entoles
#packages>install>search to paketo>install
#tha sou grapsei katw sxetika me tin epitixia tou install
#meta trexeis tis entoles wste na fortwthoun
library(VGAM)
library(corrplot)
library(Rchoice)
library(ggplot2)
library(dplyr)
library(plotly)
library(fmsb)
library(data.table)
library(ggpubr)
# an xreiasteis allo paketo na to kaneis install kai na to fortwseis
# opws ekana kai egw st alla
# Part 1: eisagwgi data kai epeksergasia
final_database<-read.csv2("final_dataset.csv", header=T,dec=".",sep=",")
# prosoxi! exw valei to full path
# o 101 einai autos pou exei kai vathmologies 6 kai NAN to petame eksw
outlier<-c(101)
# to epomeno pataei eksw oso pid=outlier kai exoume ta data1 pou einai kai ta genika
data1<- final_database[-which(final_database$pid %in% outlier), ]
# tou lew oti to accept einai ordinal variable na to kserei apo twra
#data1$accept<-as.ordered(data1$accept)
# ftiaxnw twra kai epimerous set dedomenwn
no<-c(0)
# set me xristes dimosia sigkoinwnia
data_pt<-data1[-which(data1$pt %in% no), ]
# set me xristes car or bike, prive diladi mesa
data_car<-data1[-which(data1$car %in% no) , ]
# set me xristes walk or bicycle, active diladi mesa
data_vru<-data1[-which((data1$walk %in% no) & (data1$bicycle %in% no) & (data1$bike %in% no)), ]
# Part 2: perigrafika statistika deigmatos
# loipon thelw mia pita andres/gunaikes
sex_data<-count(data1, sex)
sex_labels<-c("Female","Male","Other") # prosekse ti seira ton onomatwn, oi andres sto deigma mas htan pio polloi: 0: female, 1: male
plot_ly(sex_data, labels = ~sex_labels, values = ~sex_data$n, type = 'pie') #krata auto to diagrama
# mia pita me tis ilikiakes omades
age_data<-count(data1,age)/12
age_label<-c("18-20 years old","21-30 years old","31-40 years old","41-50 years old", "51-65 years old", "65 years or older")
plot_ly(age_data, labels = ~age_label, values = ~age_data$n, type = 'pie') #krata auto tipota perissotero na exoyme sinoxi
# grafimaa me stiles, gia ton arithmo twn respodent ana meso metakinisis
modes_data<-c(sum(data1$car)/12,sum(data1$bike)/12,sum(data1$pt)/12,sum(data1$walk)/12,sum(data1$bicycle)/12)
# double check oti 51+16+52+10+2=131 * 12 = 1572 == 1527 pou einai o arithmos twn observations sto data1, ara oloi mas edwsan meso metakinisis
modes_label<-c("Car","Motorcycle","Public Transport","Walk","Bicycle")
ggplot(data.frame(modes_label,modes_data),aes(x=modes_label,y=modes_data))+
geom_bar(stat="identity")+
theme_bw()+
labs(title = "Prefered Mode of Transport")+labs(x ="Mode of Transport", y = "Number of Respondents") #krata auto to grafimataki, einai ok
# Part 3: ratings
intentions<-c("envi","stress","fatigue","timeben","comfort","economy","autonomy","physical","secure","prestige")
#ftiakase ligo kalitera kai sta Agglika auta ta labels dioti mpainoun meta sto diagramma.
data_walk<-data1[-which(data1$walk %in% no), ]
data_bicycle<-data1[-which(data1$bicycle %in% no), ]
data_bike<-data1[-which(data1$bike %in% no), ]
rating_car<-c(mean(na.omit(data_car$envi)),mean(na.omit(data_car$stress)),mean(na.omit(data_car$fatigue)),mean(na.omit(data_car$timeben)),
mean(na.omit(data_car$comfort)),mean(na.omit(data_car$economy)),mean(na.omit(data_car$autonomy)),mean(na.omit(data_car$physical)),
mean(na.omit(data_car$secure)),mean(na.omit(data_car$prestige))) # ena thema pou eixes me ta statistika htan oti ipirxan
# NaN kathws stin arxi den ta eixame ta ratings
rating_pt<-c(mean(na.omit(data_pt$envi)),mean(na.omit(data_pt$stress)),mean(na.omit(data_pt$fatigue)),mean(na.omit(data_pt$timeben)),
mean(na.omit(data_pt$comfort)),mean(na.omit(data_pt$economy)),mean(na.omit(data_pt$autonomy)),mean(na.omit(data_pt$physical)),
mean(na.omit(data_pt$secure)),mean(na.omit(data_pt$prestige)))
rating_vru<-c(mean(na.omit(data_vru$envi)),mean(na.omit(data_vru$stress)),mean(na.omit(data_vru$fatigue)),mean(na.omit(data_vru$timeben)),
mean(na.omit(data_vru$comfort)),mean(na.omit(data_vru$economy)),mean(na.omit(data_vru$autonomy)),mean(na.omit(data_vru$physical)),
mean(na.omit(data_vru$secure)),mean(na.omit(data_vru$prestige)))
rating<-data.frame(rating_car,rating_pt,rating_vru)# wraia me autin tin entonli ftiaxnetai to pinakaki pou legame
rownames(rating)<-intentions
write.csv(x=rating, file="C:/Users/panos/Google Drive/research_papers/paper8_acceptability/rating_user.csv") # allakse to path
# an kai to perasa to pinakaki sto koino excel
#edw exvw entoles wste na vgei ena spyder chart. ?????????????? ????????????
rating2<-transpose(rating)
rownames(rating2)<-colnames(rating)
colnames(rating2)<-rownames(rating)
rating2 <- rbind(5 , 1 , rating2)
library(RColorBrewer)
coul <- brewer.pal(3, "BuPu")
colors_border <- coul
library(scales)
colors_in <- alpha(coul,0.3)
radarchart(rating2[-c(1,2),], axistype=0 , maxmin=F,
pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
cglcol="grey", cglty=1, axislabcol="black", cglwd=0.8,
vlcex=0.8)
legend(x=1, y=1, legend = rownames(rating2[-c(1,2),]), bty = "n", pch=20 ,
col=colors_in , text.col = "grey", cex=1.2, pt.cex=3)
# Part 4: accept perigrafika statistika
summary(data1$accept) #den xreiazetai diagramma apla sxoliasmos twn apotelesmatwn kai oti apefigan akraies times
data1$accept<-as.factor(data1$accept)
# krata ta katw diagrammata kai eimaste ok
# accept vs speed limit
p1<-ggplot(data_car, aes(x = as.factor(accept), y = speed)) + geom_violin(fill = "cornflowerblue")+
labs(title = "Car Users", y="Speed limit (km/h)")
p2<-ggplot(data_pt, aes(x = as.factor(accept), y = speed)) + geom_violin(fill = "cornflowerblue")+
labs(title="Public Trasnport Users",x = "Acceptability", y="Speed limit (km/h)")
p3<-ggplot(data_vru, aes(x = as.factor(accept), y = speed)) + geom_violin(fill = "cornflowerblue")+
labs(title="Vulnerable Road Users",x = "Acceptability", y="Speed limit (km/h)")
ggarrange(p1, p2, p3,ncol = 1, nrow = 3)
# accept vs number of lanes
p1<-ggplot(data_car, aes(x = as.factor(accept), y = lanes)) + geom_violin(fill = "cornflowerblue")+
labs(title = "Car Users", y="Number of lanes")
p2<-ggplot(data_pt, aes(x = as.factor(accept), y = lanes)) + geom_violin(fill = "cornflowerblue")+
labs(title="Public Trasnport Users",x = "Acceptability", y="Number of lanes")
p3<-ggplot(data_vru, aes(x = as.factor(accept), y = lanes)) + geom_violin(fill = "cornflowerblue")+
labs(title="Vulnerable Road Users",x = "Acceptability", y="Number of lanes")
ggarrange(p1, p2, p3,ncol = 1, nrow = 3)
# accept vs mean delay of motorized traffic
p1<-ggplot(data_car, aes(x = as.factor(accept), y = mdelay)) + geom_violin(fill = "coral2")+
labs(title = "Car Users", y="Traffic delay (min)")
p2<-ggplot(data_pt, aes(x = as.factor(accept), y = mdelay)) + geom_violin(fill = "cornflowerblue")+
labs(title="Public Trasnport Users",x = "Social Acceptance", y="Traffic delay (min)")
p3<-ggplot(data_vru, aes(x = as.factor(accept), y = mdelay)) + geom_violin(fill = "darkseagreen1")+
labs(title="Vulnerable Road Users",x = "Social Acceptance", y="Traffic delay (min)")
ggarrange(p1, p2, p3,ncol = 1, nrow = 3)
# accept vs PT waiting time
p1<-ggplot(data_car, aes(x = as.factor(accept), y = wait_pt)) + geom_violin(fill = "coral2")+
labs(title = "Car Users", y="PT waiting time (min)")
p2<-ggplot(data_pt, aes(x = as.factor(accept), y = wait_pt)) + geom_violin(fill = "cornflowerblue")+
labs(title="Public Trasnport Users",x = "Acceptability", y="PT waiting time (min)")
p3<-ggplot(data_vru, aes(x = as.factor(accept), y = wait_pt)) + geom_violin(fill = "darkseagreen1")+
labs(title="Vulnerable Road Users",x = "Acceptability", y="PT waiting time (min)")
ggarrange(p1, p2, p3,ncol = 1, nrow = 3)
# accept vs bus lane
p1<-ggplot(data_car, aes(x = as.factor(accept), y = bus)) + geom_violin(fill = "coral2")+
labs(title = "Car Users", y="Bus lane (yes = 1)")
p2<-ggplot(data_pt, aes(x = as.factor(accept), y = bus)) + geom_violin(fill = "cornflowerblue")+
labs(title="Public Trasnport Users",x = "Acceptability", y="Bus lane (yes = 1)")
p3<-ggplot(data_vru, aes(x = as.factor(accept), y = bus)) + geom_violin(fill = "darkseagreen1")+
labs(title="Vulnerable Road Users",x = "Acceptability", y="Bus lane (yes = 1)")
#Part 0: packages
#edw auta ta paketa prepei prwta na ta kaneis install kai meta na trekseis tis entoles
#packages>install>search to paketo>install
#tha sou grapsei katw sxetika me tin epitixia tou install
#meta trexeis tis entoles wste na fortwthoun
library(VGAM)
library(corrplot)
library(Rchoice)
library(ggplot2)
library(dplyr)
library(plotly)
library(fmsb)
library(data.table)
library(ggpubr)
# an xreiasteis allo paketo na to kaneis install kai na to fortwseis
# opws ekana kai egw st alla
# Part 1: eisagwgi data kai epeksergasia
final_database<-read.csv2("final_dataset.csv", header=T,dec=".",sep=",")
# prosoxi! exw valei to full path
# o 101 einai autos pou exei kai vathmologies 6 kai NAN to petame eksw
outlier<-c(101)
# to epomeno pataei eksw oso pid=outlier kai exoume ta data1 pou einai kai ta genika
data1<- final_database[-which(final_database$pid %in% outlier), ]
# tou lew oti to accept einai ordinal variable na to kserei apo twra
#data1$accept<-as.ordered(data1$accept)
# ftiaxnw twra kai epimerous set dedomenwn
no<-c(0)
# set me xristes dimosia sigkoinwnia
data_pt<-data1[-which(data1$pt %in% no), ]
# set me xristes car or bike, prive diladi mesa
data_car<-data1[-which(data1$car %in% no) , ]
# set me xristes walk or bicycle, active diladi mesa
data_vru<-data1[-which((data1$walk %in% no) & (data1$bicycle %in% no) & (data1$bike %in% no)), ]
# Part 2: perigrafika statistika deigmatos
# loipon thelw mia pita andres/gunaikes
sex_data<-count(data1, sex)
sex_labels<-c("Female","Male","Other") # prosekse ti seira ton onomatwn, oi andres sto deigma mas htan pio polloi: 0: female, 1: male
plot_ly(sex_data, labels = ~sex_labels, values = ~sex_data$n, type = 'pie') #krata auto to diagrama
# mia pita me tis ilikiakes omades
age_data<-count(data1,age)/12
age_label<-c("18-20 years old","21-30 years old","31-40 years old","41-50 years old", "51-65 years old", "65 years or older")
plot_ly(age_data, labels = ~age_label, values = ~age_data$n, type = 'pie') #krata auto tipota perissotero na exoyme sinoxi
# grafimaa me stiles, gia ton arithmo twn respodent ana meso metakinisis
modes_data<-c(sum(data1$car)/12,sum(data1$bike)/12,sum(data1$pt)/12,sum(data1$walk)/12,sum(data1$bicycle)/12)
# double check oti 51+16+52+10+2=131 * 12 = 1572 == 1527 pou einai o arithmos twn observations sto data1, ara oloi mas edwsan meso metakinisis
modes_label<-c("Car","Motorcycle","Public Transport","Walk","Bicycle")
ggplot(data.frame(modes_label,modes_data),aes(x=modes_label,y=modes_data))+
geom_bar(stat="identity")+
theme_bw()+
labs(title = "Prefered Mode of Transport")+labs(x ="Mode of Transport", y = "Number of Respondents") #krata auto to grafimataki, einai ok
# Part 3: ratings
intentions<-c("envi","stress","fatigue","timeben","comfort","economy","autonomy","physical","secure","prestige")
#ftiakase ligo kalitera kai sta Agglika auta ta labels dioti mpainoun meta sto diagramma.
data_walk<-data1[-which(data1$walk %in% no), ]
data_bicycle<-data1[-which(data1$bicycle %in% no), ]
data_bike<-data1[-which(data1$bike %in% no), ]
rating_car<-c(mean(na.omit(data_car$envi)),mean(na.omit(data_car$stress)),mean(na.omit(data_car$fatigue)),mean(na.omit(data_car$timeben)),
mean(na.omit(data_car$comfort)),mean(na.omit(data_car$economy)),mean(na.omit(data_car$autonomy)),mean(na.omit(data_car$physical)),
mean(na.omit(data_car$secure)),mean(na.omit(data_car$prestige))) # ena thema pou eixes me ta statistika htan oti ipirxan
# NaN kathws stin arxi den ta eixame ta ratings
rating_pt<-c(mean(na.omit(data_pt$envi)),mean(na.omit(data_pt$stress)),mean(na.omit(data_pt$fatigue)),mean(na.omit(data_pt$timeben)),
mean(na.omit(data_pt$comfort)),mean(na.omit(data_pt$economy)),mean(na.omit(data_pt$autonomy)),mean(na.omit(data_pt$physical)),
mean(na.omit(data_pt$secure)),mean(na.omit(data_pt$prestige)))
rating_vru<-c(mean(na.omit(data_vru$envi)),mean(na.omit(data_vru$stress)),mean(na.omit(data_vru$fatigue)),mean(na.omit(data_vru$timeben)),
mean(na.omit(data_vru$comfort)),mean(na.omit(data_vru$economy)),mean(na.omit(data_vru$autonomy)),mean(na.omit(data_vru$physical)),
mean(na.omit(data_vru$secure)),mean(na.omit(data_vru$prestige)))
rating<-data.frame(rating_car,rating_pt,rating_vru)# wraia me autin tin entonli ftiaxnetai to pinakaki pou legame
rownames(rating)<-intentions
write.csv(x=rating, file="C:/Users/panos/Google Drive/research_papers/paper8_acceptability/rating_user.csv") # allakse to path
# an kai to perasa to pinakaki sto koino excel
#edw exvw entoles wste na vgei ena spyder chart. ?????????????? ????????????
rating2<-transpose(rating)
rownames(rating2)<-colnames(rating)
colnames(rating2)<-rownames(rating)
rating2 <- rbind(5 , 1 , rating2)
library(RColorBrewer)
coul <- brewer.pal(3, "BuPu")
colors_border <- coul
library(scales)
colors_in <- alpha(coul,0.3)
radarchart(rating2[-c(1,2),], axistype=0 , maxmin=F,
pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
cglcol="grey", cglty=1, axislabcol="black", cglwd=0.8,
vlcex=0.8)
legend(x=1, y=1, legend = rownames(rating2[-c(1,2),]), bty = "n", pch=20 ,
col=colors_in , text.col = "grey", cex=1.2, pt.cex=3)
# Part 4: accept perigrafika statistika
summary(data1$accept) #den xreiazetai diagramma apla sxoliasmos twn apotelesmatwn kai oti apefigan akraies times
data1$accept<-as.factor(data1$accept)
# krata ta katw diagrammata kai eimaste ok
# accept vs speed limit
p1<-ggplot(data_car, aes(x = as.factor(accept), y = speed)) + geom_violin(fill = "cornflowerblue")+
labs(title = "Car Users", y="Speed limit (km/h)")
p2<-ggplot(data_pt, aes(x = as.factor(accept), y = speed)) + geom_violin(fill = "cornflowerblue")+
labs(title="Public Trasnport Users",x = "Acceptability", y="Speed limit (km/h)")
p3<-ggplot(data_vru, aes(x = as.factor(accept), y = speed)) + geom_violin(fill = "cornflowerblue")+
labs(title="Vulnerable Road Users",x = "Acceptability", y="Speed limit (km/h)")
ggarrange(p1, p2, p3,ncol = 1, nrow = 3)
# accept vs number of lanes
p1<-ggplot(data_car, aes(x = as.factor(accept), y = lanes)) + geom_violin(fill = "cornflowerblue")+
labs(title = "Car Users", y="Number of lanes")
p2<-ggplot(data_pt, aes(x = as.factor(accept), y = lanes)) + geom_violin(fill = "cornflowerblue")+
labs(title="Public Trasnport Users",x = "Acceptability", y="Number of lanes")
p3<-ggplot(data_vru, aes(x = as.factor(accept), y = lanes)) + geom_violin(fill = "cornflowerblue")+
labs(title="Vulnerable Road Users",x = "Acceptability", y="Number of lanes")
ggarrange(p1, p2, p3,ncol = 1, nrow = 3)
# accept vs mean delay of motorized traffic
p1<-ggplot(data_car, aes(x = as.factor(accept), y = mdelay)) + geom_violin(fill = "coral2")+
labs(title = "Car Users", y="Traffic delay (min)")
p2<-ggplot(data_pt, aes(x = as.factor(accept), y = mdelay)) + geom_violin(fill = "cornflowerblue")+
labs(title="Public Trasnport Users",x = "Social Acceptance", y="Traffic delay (min)")
p3<-ggplot(data_vru, aes(x = as.factor(accept), y = mdelay)) + geom_violin(fill = "darkseagreen1")+
labs(title="Vulnerable Road Users",x = "Social Acceptance", y="Traffic delay (min)")
ggarrange(p1, p2, p3,ncol = 1, nrow = 3)
# accept vs PT waiting time
p1<-ggplot(data_car, aes(x = as.factor(accept), y = wait_pt)) + geom_violin(fill = "coral2")+
labs(title = "Car Users", y="PT waiting time (min)")
p2<-ggplot(data_pt, aes(x = as.factor(accept), y = wait_pt)) + geom_violin(fill = "cornflowerblue")+
labs(title="Public Trasnport Users",x = "Acceptability", y="PT waiting time (min)")
p3<-ggplot(data_vru, aes(x = as.factor(accept), y = wait_pt)) + geom_violin(fill = "darkseagreen1")+
labs(title="Vulnerable Road Users",x = "Acceptability", y="PT waiting time (min)")
ggarrange(p1, p2, p3,ncol = 1, nrow = 3)
# accept vs bus lane
p1<-ggplot(data_car, aes(x = as.factor(accept), y = bus)) + geom_violin(fill = "coral2")+
labs(title = "Car Users", y="Bus lane (yes = 1)")
p2<-ggplot(data_pt, aes(x = as.factor(accept), y = bus)) + geom_violin(fill = "cornflowerblue")+
labs(title="Public Trasnport Users",x = "Acceptability", y="Bus lane (yes = 1)")
p3<-ggplot(data_vru, aes(x = as.factor(accept), y = bus)) + geom_violin(fill = "darkseagreen1")+
labs(title="Vulnerable Road Users",x = "Acceptability", y="Bus lane (yes = 1)")
#Part 0: packages
#edw auta ta paketa prepei prwta na ta kaneis install kai meta na trekseis tis entoles
#packages>install>search to paketo>install
#tha sou grapsei katw sxetika me tin epitixia tou install
#meta trexeis tis entoles wste na fortwthoun
library(VGAM)
library(corrplot)
library(Rchoice)
library(ggplot2)
library(dplyr)
library(plotly)
library(fmsb)
library(data.table)
library(ggpubr)
# an xreiasteis allo paketo na to kaneis install kai na to fortwseis
# opws ekana kai egw st alla
# Part 1: eisagwgi data kai epeksergasia
final_database<-read.csv2("final_dataset.csv", header=T,dec=".",sep=",")
# prosoxi! exw valei to full path
# o 101 einai autos pou exei kai vathmologies 6 kai NAN to petame eksw
outlier<-c(101)
# to epomeno pataei eksw oso pid=outlier kai exoume ta data1 pou einai kai ta genika
data1<- final_database[-which(final_database$pid %in% outlier), ]
# tou lew oti to accept einai ordinal variable na to kserei apo twra
#data1$accept<-as.ordered(data1$accept)
# Part 1: eisagwgi data kai epeksergasia
final_database<-read.csv2("final_dataset.csv", header=T,dec=".",sep=",")
# prosoxi! exw valei to full path
# o 101 einai autos pou exei kai vathmologies 6 kai NAN to petame eksw
outlier<-c(101)
# to epomeno pataei eksw oso pid=outlier kai exoume ta data1 pou einai kai ta genika
data1<- final_database[-which(final_database$pid %in% outlier), ]
# tou lew oti to accept einai ordinal variable na to kserei apo twra
#data1$accept<-as.ordered(data1$accept)
plot(model1, pch=20)
model2<-lm(speed2~ cross + shared + shared*cross, data=subset(veh_data, park==1))
summary(model2)
gvlma(model2)
par(mfrow=c(2,2))
library(ggplot2)
library(hrbrthemes)
library(dplyr)
library(ggpubr)
library(gvlma)
library(psych)
model2<-lm(speed2~ cross, data=subset(veh_data, park==1 & shared==1))
summary(model2)
gvlma(model2)
par(mfrow=c(2,2))
plot(model2, pch=20)
library(Rchoice)
library(corrplot)
library(ggplot2)
library(RColorBrewer)
library(ggpubr)
library(ggplot2)
library(ggplot2)
library(ggpubr)
library(corrplot)
library(gvlma)
library(olsrr)
library(RColorBrewer)
library(psych)
library(dplyr)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
gerdat<-read.csv2('datasets/datasets_germany_DESIGN.csv', header=T, dec=".", sep=",")
eldat<-read.csv2('datasets/amalias_traffic_dataset_DESIGN.csv', header=T, dec=".", sep=",")
#
# NEW DATASET TO PLAY WITH
datafr_fun <- function(df, x, dats, limit){
if(dats == 'dats1'){datafr<-data.frame(case=x, flow=30*subset(df, case==x)$n_cars + 30*subset(df, case==x)$n_cyclists,
# all vehicles in veh/h, no pcu was used...
# cyclists cannot be considered separately
# since no cyclists recorded in Nafplio, Greece
speed = subset(df, case==x)$mean_car_speed,
dspeed = subset(df, case==x)$mean_car_speed - mean(subset(df, case==x)$mean_car_speed),
# deviation from the mean speed.
lspeed = subset(df, case==x)$mean_car_speed - limit,
# difference from the speed limit, compliance of drivers
comply = subset(df, case==x)$mean_car_speed/limit,
ped = 30*subset(df, case==x)$n_pedestrians,
# flow of pedestrians per hour
cross = 30*subset(df, case==x)$ped_crossing)}
if(dats == 'dats2'){datafr<-data.frame(case=x, flow=60/subset(df, case==x)$headway,
# calculation flows from headways
speed = subset(df, case==x)$speed,
dspeed = subset(df, case==x)$speed - mean(subset(df, case==x)$speed),
lspeed = subset(df, case==x)$speed - limit, # there is no speed limit, suppose 30
comply = subset(df, case==x)$speed/limit,
ped = 30*subset(df, case==x)$ped,
cross = 30*subset(df, case==x)$cross)}
datafr<-cbind(datafr, data.frame(shared = subset(df, case==x)$shared,
# 1, if shared space, only one section
oneway = subset(df, case==x)$oneway,
lanes = subset(df, case==x)$lanes,
# 1, if oneway road
# park = subset(df, case==x)$park, # no use, all section with parking
mark = subset(df, case==x)$mark,
# 1, if road markings
trees = subset(df, case==x)$trees,
# 1, if trees
bollards = subset(df, case==x)$bollards,
# 1, if bollards
width = subset(df, case==x)$width,
# width of the pavement
cross_y = subset(df, case==x)$cross_y,
# 1, existence of courtesy crossings
s_width = subset(df, case==x)$s_width,
# 1, sidewalk width
# inters = subset(df, case==x)$inters, no use of this variable
bench = subset(df, case==x)$bench,
# 1, if benches
obst = subset(df, case==x)$obst,
# 1, if obstacles
lev_segr = subset(df, case==x)$lev_segr),
vis_segr = subset(df, case==x)$vis_segr) # 1, if level segregatioN
return(datafr)}
traf<-datafr_fun(gerdat,'fsbr', 'dats1', 20) # fsbr 20 km/h
traf<-rbind(traf, datafr_fun(gerdat,'lsho', 'dats1', 10)) # 10 km/h
traf<-rbind(traf, datafr_fun(gerdat,'mke', 'dats1', 20)) # 20 km/h
traf<-rbind(traf, datafr_fun(eldat,'shnaf','dats2', 30)) # # 30 km/h
traf$comply<-replace(traf$comply, traf$comply==0, 1)
# traf<-rbind(traf, datafr_fun(eldat,'covnaf', 'dats2')) # no conventional section imported in the aanalyis
# CORRELATIONS
corr<-function(df, x){ # plot correlation table funntion
corel = df
M = cor(corel)
testRes=cor.mtest(corel, conf.level=x)
corrplot(M, method = 'number', p.mat = testRes$p, sig.level = 1-x, diag=FALSE)}
corr(subset(traf, select=(-case)), 0.95)
# with X no significant correlations
# no correlation between speed deviation and crossing or flow
# but compliance have some interesting correlations...correlation with crossiing, not with flows.
# positive correlation with flow (????), high speed when we have high flow ??
# maybe free flow branch and car dominance lead to higher speeds..
# positive and significant correlation with road width and courtesy crossings, positive
# in crossing, super strong correlation with ped and shared
# DESCRIPTIVE STATISTICS
traf$pedcross<-traf$cross/traf$ped # pedestrian crossings per pedestrian (relative number)
traf$shpedspace<-(2*traf$s_width)/(2*traf$s_width + traf$width) # percentage of ped space over all
traf$shped<-traf$ped/(traf$flow + traf$ped)
# A. descriptive statistics..!
describe(subset(traf, case=='fsbr')$speed)
describe(subset(traf, case=='lsho')$speed)
describe(subset(traf, case=='mke')$speed)
describe(subset(traf, case=='shnaf')$speed)
ggplot(traf, aes(y=dspeed, x=as.factor(cross/30))) +
geom_boxplot(fill = "cadetblue1") + theme_bw() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_x_discrete(name ="Speed deviation in km/h") +
scale_y_continuous(name ="Pedestrian crossing in peds/2 minutes")
ggplot(traf, aes(y=dspeed, x=as.factor(cross/30))) +
geom_boxplot(fill = "cadetblue1") + theme_bw() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_y_discrete(name ="Speed deviation in km/h") +
scale_x_continuous(name ="Pedestrian crossing in peds/2 minutes")
ggplot(traf, aes(y=dspeed, x=as.factor(cross/30))) +
geom_boxplot(fill = "cadetblue1") + theme_bw() +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) +
scale_y_continuous(name ="Speed deviation in km/h") +
scale_x_discrete(name ="Pedestrian crossing in peds/2 minutes")
traf$ped2<-traf$ped/30
model4<-lm(comply ~ shpedspace + ped2, data = traf[-c(250, 170, 157),])
summary(model4)
