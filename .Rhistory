y='cross'
ggplot(traf, aes(x=as.factor(x), y=y)) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = '1, if there are bollards', limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
ggplot(traf, aes(x=as.factor(traf[x]), y=traf[y])) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = '1, if there are bollards', limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
traf[y]
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y, text){
ggplot(data, aes({{x}}, {{y}})) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
}
boxpl_fun(traf, 'cross', 'bollards', '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y, text){
ggplot(data, aes({{x}}, {{y}})) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
}
boxpl_fun(traf, 'cross', 'bollards', '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y, text){
ggplot(df, aes({{x}}, {{y}})) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
}
boxpl_fun(traf, 'cross', 'bollards', '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y, text){
ggplot(df, aes(as.factor({{x}}), {{y}})) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
}
boxpl_fun(traf, 'cross', 'bollards', '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y, text){
ggplot(df, aes({{x}}, {{y}})) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_continuous(name = text) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
}
boxpl_fun(traf, 'cross', 'bollards', '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y, text){
ggplot(df, aes({{x}}, {{y}})) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_continuous(name = text) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
}
boxpl_fun(traf, cross, bollards, '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y, text){
ggplot(df, aes(as,factor({{x}}), {{y}})) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_continuous(name = text) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
}
boxpl_fun(traf, cross, bollards, '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y, text){
ggplot(df, aes(as.factor({{x}}), {{y}})) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_continuous(name = text) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
}
boxpl_fun(traf, cross, bollards, '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y, text){
ggplot(df, aes(as.factor({{x}}), {{y}})) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
}
boxpl_fun(traf, cross, bollards, '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y, text){
ggplot(df, aes(as.factor({{x}}), {{y}})) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
}
boxpl_fun(traf, cross, bollards, '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y, text){
ggplot(df, aes(as.factor({{x}}), {{y}})) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
}
boxpl_fun(traf, bollards, cross, '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y1, y2, text){
ggplot(df, aes(as.factor({{x}}), {{y}}/30)) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
}
boxpl_fun(traf, bollards, cross, '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y1, y2, text){
ggplot(df, aes(as.factor({{x}}), {{y1}})) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
}
boxpl_fun(traf, bollards, cross, speed, '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y1, y2, text){
ggplot(df, aes(as.factor({{x}}), {{y1}}/30)) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
}
boxpl_fun(traf, bollards, cross, speed, '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y1, y2, text){
p1<-ggplot(df, aes(as.factor({{x}}), {{y1}}/30)) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
p2<-ggplot(df, aes(as.factor({{x}}), {{y2}})) + geom_boxplot( fill = "lightblue1") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Traffic speed of vehicles in km/h")
ggrrange(p1, p2, ncol=2, nrow=1)
}
boxpl_fun(traf, bollards, cross, speed, '1, if there are bollards')
library(ggplot2)
library(ggpubr)
library(corrplot)
boxpl_fun(traf, bollards, cross, speed, '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y1, y2, text){
p1<-ggplot(df, aes(as.factor({{x}}), {{y1}}/30)) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
p2<-ggplot(df, aes(as.factor({{x}}), {{y2}})) + geom_boxplot( fill = "lightblue1") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Traffic speed of vehicles in km/h")
ggarrange(p1, p2, ncol=2, nrow=1)
}
boxpl_fun(traf, bollards, cross, speed, '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y1, y2, text){
p1<-ggplot(df, aes(as.factor({{x}}), {{y1}}/30)) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
p2<-ggplot(df, aes(as.factor({{x}}), {{y2}})) + geom_boxplot( fill = "lightblue1") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Traffic speed of vehicles in km/h")
ggarrange(p1, p2, ncol=2, nrow=1)
}
boxpl_fun(traf, bollards, cross, lspeed, '1, if there are bollards')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y1, y2, text){
p1<-ggplot(df, aes(as.factor({{x}}), {{y1}}/30)) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
p2<-ggplot(df, aes(as.factor({{x}}), {{y2}})) + geom_boxplot( fill = "lightblue1") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Deviation of traffic speed from speed limit in km/h")
ggarrange(p1, p2, ncol=2, nrow=1)
}
boxpl_fun(traf, bollards, cross, lspeed, '1, if there are bollards')
library(ggplot2)
library(ggpubr)
library(corrplot)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
gerdat<-read.csv2('datasets/datasets_germany_DESIGN.csv', header=T, dec=".", sep=",")
eldat<-read.csv2('datasets/amalias_traffic_dataset_DESIGN.csv', header=T, dec=".", sep=",")
# creation of traffic dataset, with all possible cases, same data format....
datafr_fun <- function(df, x, dats){
if(dats == 'dats1'){datafr<-data.frame(case=x, flow=30*subset(df, case==x)$n_cars + 30*subset(df, case==x)$n_cyclists,
# all vehicles in veh/h, no pcu was used...
# cyclists cannot be considered separately
# since no cyclists recorded in Nafplio, Greece
dspeed = subset(df, case==x)$mean_car_speed - mean(subset(df, case==x)$mean_car_speed),
# deviation from the mean speed.
lspeed = subset(df, case==x)$mean_car_speed - 15,
# difference from the speed limit, compliance of drivers
ped = 30*subset(df, case==x)$n_pedestrians,
# flow of pedestrians per hour
cross = 30*subset(df, case==x)$ped_crossing)}
if(dats == 'dats2'){datafr<-data.frame(case=x, flow=60/subset(df, case==x)$headway,
# calculation flows from headways
dspeed = subset(df, case==x)$speed - mean(subset(df, case==x)$speed),
lspeed = subset(df, case==x)$speed - 30, # there is no speed limit, suppose 30
ped = 30*subset(df, case==x)$ped,
cross = 30*subset(df, case==x)$cross)}
datafr<-cbind(datafr, data.frame(shared = subset(df, case==x)$shared,
# 1, if shared space, only one section
oneway = subset(df, case==x)$oneway,
# 1, if oneway road
# park = subset(df, case==x)$park, # no use, all section with parking
mark = subset(df, case==x)$mark,
# 1, if road markings
trees = subset(df, case==x)$trees,
# 1, if trees
bollards = subset(df, case==x)$bollards,
# 1, if bollards
width = subset(df, case==x)$width,
# width of the pavement
cross_y = subset(df, case==x)$cross_y,
# 1, existence of courtesy crossings
s_width = subset(df, case==x)$s_width,
# 1, sidewalk width
# inters = subset(df, case==x)$inters, no use of this variable
bench = subset(df, case==x)$bench,
# 1, if benches
obst = subset(df, case==x)$obst,
# 1, if obstacles
lev_segr = subset(df, case==x)$lev_segr)) # 1, if level segregatioN
return(datafr)}
traf<-datafr_fun(gerdat,'fsbr', 'dats1')
traf<-rbind(traf, datafr_fun(gerdat,'lsho', 'dats1'))
traf<-rbind(traf, datafr_fun(gerdat,'mke', 'dats1'))
traf<-rbind(traf, datafr_fun(eldat,'shnaf','dats2'))
corr<-function(df, x){
corel = df
M = cor(corel)
testRes=cor.mtest(corel, conf.level=x)
corrplot(M, method = 'number', p.mat = testRes$p, sig.level = 1-x, diag=FALSE)}
corr(subset(traf, select=(-case)), 0.90)
# new variables...
traf$shped<-traf$ped/(traf$flow + traf$ped) # percentage of pedestrians over all moving objects
traf$distspace<-traf$width/(2*traf$s_width + traf$width) # ratio of vehicle space vs pedestrian space
corr(subset(traf, select=(-case)), 0.99)
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y1, y2, text){
p1<-ggplot(df, aes(as.factor({{x}}), {{y1}}/30)) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Pedestrian crossings in peds/2 minutes")
p2<-ggplot(df, aes(as.factor({{x}}), {{y2}})) + geom_boxplot( fill = "lightblue1") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Deviation of traffic speed from speed limit in km/h")
ggarrange(p1, p2, ncol=2, nrow=1)
}
boxpl_fun(traf, bollards, cross, lspeed, '1, if there are bollards')
View(traf)
shapiro.test(traf$lspeed)
shapiro.test(traf$cross)
shaprio.test(traf$dspeed)
shapiro.test(traf$dspeed)
wilcox<-function(df, x, y1, y2){
wilcox.test(subset(df, {{x}}=1)[y1], subset(df, {{x}}=0)[y1])
}
wilcox<-function(df, x, y1, y2){
wilcox.test(subset(df, {{x}}=1)[y1], subset(df, {{x}}=0)[y1])}
wilcox<-function(df, x, y1, y2){
wilcox.test(subset(df, {{x}}==1)[y1], subset(df, {{x}}==0)[y1])}
boxpl_fun(traf, bollards, cross, lspeed, '1, if there are bollards')
wilcox(traf, bollards, cross, lspeed)
View(traf)
traf$bollards
boxpl_fun(traf, bollards, cross, lspeed, '1, if there are bollards')
wilcox.test(subset(traf, bollards = 1)$cross, subset(traf, bollards = 0)$cross, exact=FALSE, paired=FALSE)
boxpl_fun(traf, bollards, cross, lspeed, '1, if there are bollards')
wilcox.test(subset(traf, bollards == 1)$cross, subset(traf, bollards == 0)$cross, exact=FALSE, paired=FALSE)
boxpl_fun(traf, bollards, cross, lspeed, '1, if there are bollards')
wilcox.test(subset(traf, bollards == 1)$cross, subset(traf, bollards == 0)$cross, exact=FALSE, paired=FALSE)
wilcox.test(subset(traf, bollards == 1)$lspeed, subset(traf, bollards == 0)$lspeed, exact=FALSE, paired=FALSE)
mean(subset(traf, bollards == 1)$cross) - mean(subset(traf, bollards == 0)$cross)
mean(subset(traf, bollards == 1)$cross/30) - mean(subset(traf, bollards == 0)$cross/30)
# statistically significant difference for 95% confidence interval
mean(subset(traf, bollards == 1)$speed) - mean(subset(traf, bollards == 0)$speed)
# statistically significant difference for 95% confidence interval
mean(subset(traf, bollards == 1)$lspeed) - mean(subset(traf, bollards == 0)$lspeed)
# Zebra crossing, yes or no
mean(subset(traf, crors_y == 1)$cross/30) - mean(subset(traf, cross_y == 0)$cross/30) # 2.5 more crossings
# Zebra crossing, yes or no
mean(subset(traf, cross_y == 1)$cross/30) - mean(subset(traf, cross_y == 0)$cross/30) # 2.5 more crossings
wilcox.test(subset(traf, cross_y == 1)$cross, subset(traf, cross_y == 0)$cross, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
mean(subset(traf, cross_y == 1)$lspeed) - mean(subset(traf, cross_y == 0)$lspeed) # 3.8 higher speed than the speed limit
wilcox.test(subset(traf, cross_y == 1)$lspeed, subset(traf, cross_y == 0)$lspeed, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, cross_y, cross, lspeed, '1, if there are bollards')
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, cross_y, cross, lspeed, '1, if there are zebra crossings')
# Zebra crossing, yes or no
mean(subset(traf, cross_y == 1)$cross/30) - mean(subset(traf, cross_y == 0)$cross/30) # 2.5 more crossings
# statistically significant difference for 95% confidence interval
mean(subset(traf, cross_y == 1)$lspeed) - mean(subset(traf, cross_y == 0)$lspeed) # 3.8 higher speed than the speed limit
# Trees, yes or no
mean(subset(traf, trees == 1)$cross/30) - mean(subset(traf, trees == 0)$cross/30) # 1.9 less crossings
wilcox.test(subset(traf, trees == 1)$cross, subset(traf, trees == 0)$cross, exact=FALSE, paired=FALSE)
# Trees, yes or no
mean(subset(traf, trees == 1)$cross/30) - mean(subset(traf, trees == 0)$cross/30) # 1.9 less crossings
wilcox.test(subset(traf, trees == 1)$cross, subset(traf, trees == 0)$cross, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
mean(subset(traf, trees == 1)$lspeed) - mean(subset(traf, trees == 0)$lspeed) # 5.6 higher speed than the speed limit
wilcox.test(subset(traf, trees == 1)$lspeed, subset(traf, trees == 0)$lspeed, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, trees, cross, lspeed, '1, if there are zebra pedestrian crossings')
# Trees, yes or no
mean(subset(traf, trees == 1)$cross/30) - mean(subset(traf, trees == 0)$cross/30) # 1.9 less crossings
wilcox.test(subset(traf, trees == 1)$cross, subset(traf, trees == 0)$cross, exact=FALSE, paired=FALSE)
# Level_segregation, yes or no
mean(subset(traf, lev_segr == 1)$cross/30) - mean(subset(traf, lev_segr == 0)$cross/30) # 3.1 less crossings
wilcox.test(subset(traf, lev_segr == 1)$cross, subset(traf, lev_segr == 0)$cross, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
mean(subset(traf, lev_segr == 1)$lspeed) - mean(subset(traf, lev_segr == 0)$lspeed) # 1.2 higher speed than the speed limit
wilcox.test(subset(traf, lev_segr == 1)$lspeed, subset(traf, lev_segr == 0)$lspeed, exact=FALSE, paired=FALSE)
wilcox.test(subset(traf, trees == 1)$lspeed, subset(traf, trees == 0)$lspeed, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, trees, cross, lspeed, '1, if there are trees')
# Level_segregation, yes or no
mean(subset(traf, lev_segr == 1)$cross/30) - mean(subset(traf, lev_segr == 0)$cross/30) # 3.1 less crossings
wilcox.test(subset(traf, lev_segr == 1)$cross, subset(traf, lev_segr == 0)$cross, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
mean(subset(traf, lev_segr == 1)$lspeed) - mean(subset(traf, lev_segr == 0)$lspeed) # 1.2 higher speed than the speed limit
wilcox.test(subset(traf, lev_segr == 1)$lspeed, subset(traf, lev_segr == 0)$lspeed, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, lev_segr, cross, lspeed, '1, if there is level segregation')
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, trees, cross, lspeed, '1, if there are trees')
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, lev_segr, cross, lspeed, '1, if there is level segregation')
# Level_segregation, yes or no
mean(subset(traf, lev_segr == 1)$cross/30) - mean(subset(traf, lev_segr == 0)$cross/30) # 3.1 less crossings
wilcox.test(subset(traf, lev_segr == 1)$cross, subset(traf, lev_segr == 0)$cross, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
mean(subset(traf, lev_segr == 1)$lspeed) - mean(subset(traf, lev_segr == 0)$lspeed) # 1.2 higher speed than the speed limit
wilcox.test(subset(traf, lev_segr == 1)$lspeed, subset(traf, lev_segr == 0)$lspeed, exact=FALSE, paired=FALSE)
# Bench, yes or no
mean(subset(traf, bench == 1)$cross/30) - mean(subset(traf, bench == 0)$cross/30) # 3.1 more crossings
wilcox.test(subset(traf, bench == 1)$cross, subset(traf, bench == 0)$cross, exact=FALSE, paired=FALSE)
# no significance here
mean(subset(traf, bench == 1)$lspeed) - mean(subset(traf, bench == 0)$lspeed) # 1.2 lower speed than the speed limit
# no significance here
mean(subset(traf, bench == 1)$lspeed) - mean(subset(traf, bench == 0)$lspeed) # 1.3 lower speed than the speed limit
wilcox.test(subset(traf, bench == 1)$lspeed, subset(traf, bench == 0)$lspeed, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, bench, cross, lspeed, '1, if there is level segregation')
traf$pedcross<-traf$cross/traf$ped
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, bollards, pedcross, lspeed, '1, if there are bollards')
# Obstacles, yes or no
mean(subset(traf, obst == 1)$pedcross/30) - mean(subset(traf, obst == 0)$pedcross/30) # -0.2 more crossings
wilcox.test(subset(traf, obst == 1)$cross, subset(traf, obst == 0)$cross, exact=FALSE, paired=FALSE)
# no significance here
mean(subset(traf, obst == 1)$lspeed) - mean(subset(traf, obst == 0)$lspeed) # 1.3 lower speed than the speed limit
wilcox.test(subset(traf, obst == 1)$lspeed, subset(traf, obst == 0)$lspeed, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, obst, pedcross, lspeed, '1, if there are benches')
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y1, y2, text){
p1<-ggplot(df, aes(as.factor({{x}}), {{y1}}/30)) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Number of crossings per pedestrian")
p2<-ggplot(df, aes(as.factor({{x}}), {{y2}})) + geom_boxplot( fill = "lightblue1") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Deviation of traffic speed from speed limit in km/h")
ggarrange(p1, p2, ncol=2, nrow=1)
} # box plot function to see visually the impact of each road design feature
# Bollards, yer or no
mean(subset(traf, bollards == 1)$pedcross) - mean(subset(traf, bollards == 0)$pedcross/30) # 2.5 more crossings
wilcox.test(subset(traf, bollards == 1)$pedcross, subset(traf, bollards == 0)$pedcross, exact=FALSE, paired=FALSE)
wilcox.test(subset(traf, bollards == 1)$pedcross, subset(traf, bollards == 0)$pedcross, exact=FALSE, paired=FALSE)
# Bollards, yer or no
mean(subset(traf, bollards == 1)$pedcross) - mean(subset(traf, bollards == 0)$pedcross/30) # 0.29 more crossings per pedestrian
wilcox.test(subset(traf, bollards == 1)$pedcross, subset(traf, bollards == 0)$pedcross, exact=FALSE, paired=FALSE) # significance
mean(subset(traf, bollards == 1)$lspeed) - mean(subset(traf, bollards == 0)$lspeed) # 3.8 higher speed than the speed limit
wilcox.test(subset(traf, bollards == 1)$lspeed, subset(traf, bollards == 0)$lspeed, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, bollards, pedcross, lspeed, '1, if there are bollards')
# Zebra crossing, yes or no
mean(subset(traf, cross_y == 1)$pedcross/30) - mean(subset(traf, cross_y == 0)$pedcross/30) # 1.9 less crossings
wilcox.test(subset(traf, cross_y == 1)$pedcross, subset(traf, cross_y == 0)$pedcross, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
mean(subset(traf, cross_y == 1)$lspeed) - mean(subset(traf, cross_y == 0)$lspeed) # 5.6 higher speed than the speed limit
wilcox.test(subset(traf, cross_y == 1)$lspeed, subset(traf, cross_y == 0)$lspeed, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, cross_y, cross, lspeed, '1, if there are zebra pedestrian crossings')
# Zebra crossing, yes or no
mean(subset(traf, cross_y == 1)$pedcross/30) - mean(subset(traf, cross_y == 0)$pedcross/30) # 1.9 less crossings
wilcox.test(subset(traf, cross_y == 1)$pedcross, subset(traf, cross_y == 0)$pedcross, exact=FALSE, paired=FALSE)
wilcox.test(subset(traf, cross_y == 1)$lspeed, subset(traf, cross_y == 0)$lspeed, exact=FALSE, paired=FALSE)
mean(subset(traf, cross_y == 1)$lspeed) - mean(subset(traf, cross_y == 0)$lspeed) # 5.6 higher speed than the speed limit
wilcox.test(subset(traf, cross_y == 1)$lspeed, subset(traf, cross_y == 0)$lspeed, exact=FALSE, paired=FALSE)
boxpl_fun(traf, cross_y, cross, lspeed, '1, if there are zebra pedestrian crossings')
# Trees, yes or no
mean(subset(traf, trees == 1)$pedcross/30) - mean(subset(traf, trees == 0)$pedcross/30) # 3.1 less crossings
wilcox.test(subset(traf, trees == 1)$pedcross, subset(traf, trees == 0)$pedcross, exact=FALSE, paired=FALSE)
mean(subset(traf, trees == 1)$lspeed) - mean(subset(traf, trees == 0)$lspeed) # 1.2 higher speed than the speed limit
wilcox.test(subset(traf, trees == 1)$lspeed, subset(traf, trees == 0)$lspeed, exact=FALSE, paired=FALSE) # significance
boxpl_fun(traf, trees, pedcross, lspeed, '1, if there are trees')
mean(subset(traf, trees == 1)$lspeed) - mean(subset(traf, trees == 0)$lspeed) # 1.2 higher speed than the speed limit
wilcox.test(subset(traf, trees == 1)$lspeed, subset(traf, trees == 0)$lspeed, exact=FALSE, paired=FALSE) # significance
boxpl_fun(traf, trees, pedcross, lspeed, '1, if there are trees')
shapiro.test(traf$pedcross)
# Zebra crossing, yes or no
mean(subset(traf, cross_y == 1)$pedcross/30) - mean(subset(traf, cross_y == 0)$pedcross/30) # - 0.003 less crossings
# Level_segregation, yes or no
mean(subset(traf, lev_segr == 1)$pedcross/30) - mean(subset(traf, lev_segr == 0)$pedcross/30) # 3.1 more crossings
# Level_segregation, yes or no
mean(subset(traf, lev_segr == 1)$pedcross/30) - mean(subset(traf, lev_segr == 0)$pedcross/30) # 0.0044 less crossings
wilcox.test(subset(traf, lev_segr == 1)$pedcross, subset(traf, lev_segr == 0)$pedcross, exact=FALSE, paired=FALSE)
wilcox.test(subset(traf, lev_segr == 1)$lspeed, subset(traf, lev_segr == 0)$lspeed, exact=FALSE, paired=FALSE)
mean(subset(traf, lev_segr == 1)$lspeed) - mean(subset(traf, lev_segr == 0)$lspeed) # 1.2 lower speed than the speed limit
wilcox.test(subset(traf, lev_segr == 1)$lspeed, subset(traf, lev_segr == 0)$lspeed, exact=FALSE, paired=FALSE)
boxpl_fun(traf, lev_segr, pedcross, lspeed, '1, if there is level segregation')
# Bench, yes or no
mean(subset(traf, bench == 1)$pedcross/30) - mean(subset(traf, bench == 0)$pedcross/30) # -0.2 more crossings
# Bench, yes or no
mean(subset(traf, bench == 1)$pedcross/30) - mean(subset(traf, bench == 0)$pedcross/30) # -0.2 more crossings
wilcox.test(subset(traf, bench == 1)$cross, subset(traf, bench == 0)$cross, exact=FALSE, paired=FALSE)
# 1st RQ: design vs cross and speed
# start with non-moving object check the impact
boxpl_fun<-function(df, x, y1, y2, text){
p1<-ggplot(df, aes(as.factor({{x}}), {{y1}})) + geom_boxplot( fill = "darkseagreen2") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Number of crossings per pedestrian")
p2<-ggplot(df, aes(as.factor({{x}}), {{y2}})) + geom_boxplot( fill = "lightblue1") +
geom_point(size = 1.5, alpha = .3, position = position_jitter(seed = 1, width = .2)) + theme_bw() +
scale_x_discrete(name = text, limits=c("0","1")) +
scale_y_continuous(name ="Deviation of traffic speed from speed limit in km/h")
ggarrange(p1, p2, ncol=2, nrow=1)
} # box plot function to see visually the impact of each road design feature
# Bollards, yer or no
mean(subset(traf, bollards == 1)$pedcross) - mean(subset(traf, bollards == 0)$pedcross) # 0.29 more crossings per pedestrian
wilcox.test(subset(traf, bollards == 1)$pedcross, subset(traf, bollards == 0)$pedcross, exact=FALSE, paired=FALSE) # significance
mean(subset(traf, bollards == 1)$lspeed) - mean(subset(traf, bollards == 0)$lspeed) # 3.8 higher speed than the speed limit
wilcox.test(subset(traf, bollards == 1)$lspeed, subset(traf, bollards == 0)$lspeed, exact=FALSE, paired=FALSE)
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, bollards, pedcross, lspeed, '1, if there are bollards')
# Zebra crossing, yes or no
mean(subset(traf, cross_y == 1)$pedcross) - mean(subset(traf, cross_y == 0)$pedcross) # - 0.003 less crossings
wilcox.test(subset(traf, cross_y == 1)$pedcross, subset(traf, cross_y == 0)$pedcross, exact=FALSE, paired=FALSE) # significance
mean(subset(traf, cross_y == 1)$lspeed) - mean(subset(traf, cross_y == 0)$lspeed) # 5.6 higher speed than the speed limit
wilcox.test(subset(traf, cross_y == 1)$lspeed, subset(traf, cross_y == 0)$lspeed, exact=FALSE, paired=FALSE) # significance
boxpl_fun(traf, cross_y, cross, lspeed, '1, if there are zebra pedestrian crossings')
# Trees, yes or no
mean(subset(traf, trees == 1)$pedcross) - mean(subset(traf, trees == 0)$pedcross) # -0.004 less crossings
boxpl_fun(traf, cross_y, pedcross, lspeed, '1, if there are zebra pedestrian crossings')
# Trees, yes or no
mean(subset(traf, trees == 1)$pedcross) - mean(subset(traf, trees == 0)$pedcross) # -0.004 less crossings
wilcox.test(subset(traf, trees == 1)$pedcross, subset(traf, trees == 0)$pedcross, exact=FALSE, paired=FALSE) # significance
mean(subset(traf, trees == 1)$lspeed) - mean(subset(traf, trees == 0)$lspeed) # 1.2 higher speed than the speed limit
# Trees, yes or no
mean(subset(traf, trees == 1)$pedcross) - mean(subset(traf, trees == 0)$pedcross) # -0.004 less crossings
# Trees, yes or no
mean(subset(traf, trees == 1)$pedcross) - mean(subset(traf, trees == 0)$pedcross) # -0.133 less crossings
wilcox.test(subset(traf, trees == 1)$pedcross, subset(traf, trees == 0)$pedcross, exact=FALSE, paired=FALSE) # significance
mean(subset(traf, trees == 1)$lspeed) - mean(subset(traf, trees == 0)$lspeed) # 1.2 higher speed than the speed limit
wilcox.test(subset(traf, trees == 1)$lspeed, subset(traf, trees == 0)$lspeed, exact=FALSE, paired=FALSE) # significance
boxpl_fun(traf, trees, pedcross, lspeed, '1, if there are trees')
# Level_segregation, yes or no
mean(subset(traf, lev_segr == 1)$pedcross) - mean(subset(traf, lev_segr == 0)$pedcross) # 0.0044 less crossings
# Level_segregation, yes or no
mean(subset(traf, lev_segr == 1)$pedcross) - mean(subset(traf, lev_segr == 0)$pedcross) # 0.133 less crossings
wilcox.test(subset(traf, lev_segr == 1)$pedcross, subset(traf, lev_segr == 0)$pedcross, exact=FALSE, paired=FALSE) # significance
mean(subset(traf, lev_segr == 1)$lspeed) - mean(subset(traf, lev_segr == 0)$lspeed) # 1.2 lower speed than the speed limit
wilcox.test(subset(traf, lev_segr == 1)$lspeed, subset(traf, lev_segr == 0)$lspeed, exact=FALSE, paired=FALSE) # significance
boxpl_fun(traf, lev_segr, pedcross, lspeed, '1, if there is level segregation')
# Bench, yes or no
mean(subset(traf, bench == 1)$pedcross) - mean(subset(traf, bench == 0)$pedcross) # -0.2 more crossings
# Bench, yes or no
mean(subset(traf, bench == 1)$pedcross) - mean(subset(traf, bench == 0)$pedcross) # -0.059 more crossings
wilcox.test(subset(traf, bench == 1)$cross, subset(traf, bench == 0)$cross, exact=FALSE, paired=FALSE) # no significance here
mean(subset(traf, bench == 1)$lspeed) - mean(subset(traf, bench == 0)$lspeed) # 1.3 lower speed than the speed limit
wilcox.test(subset(traf, bench == 1)$lspeed, subset(traf, bench == 0)$lspeed, exact=FALSE, paired=FALSE) # significance
boxpl_fun(traf, bench, pedcross, lspeed, '1, if there are benches')
# Obstacles, yes or no
mean(subset(traf, obst == 1)$pedcross) - mean(subset(traf, obst == 0)$pedcross) # -0.2 more crossings
wilcox.test(subset(traf, obst == 1)$cross, subset(traf, obst == 0)$cross, exact=FALSE, paired=FALSE)
# no significance here
mean(subset(traf, obst == 1)$lspeed) - mean(subset(traf, obst == 0)$lspeed) # 1.3 lower speed than the speed limit
mean(subset(traf, obst == 1)$lspeed) - mean(subset(traf, obst == 0)$lspeed) # 1.3 lower speed than the speed limit
wilcox.test(subset(traf, obst == 1)$lspeed, subset(traf, obst == 0)$lspeed, exact=FALSE, paired=FALSE) # significance
boxpl_fun(traf, obst, pedcross, lspeed, '1, if there are obstacles')
# statistically significant difference for 95% confidence interval
boxpl_fun(traf, bollards, pedcross, lspeed, '1, if there are bollards')
